var lr=Object.defineProperty;var xt=t=>{throw TypeError(t)};var cr=(t,e,o)=>e in t?lr(t,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[e]=o;var Xe=(t,e,o)=>cr(t,typeof e!="symbol"?e+"":e,o),Je=(t,e,o)=>e.has(t)||xt("Cannot "+o);var b=(t,e,o)=>(Je(t,e,"read from private field"),o?o.call(t):e.get(t)),Z=(t,e,o)=>e.has(t)?xt("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,o),be=(t,e,o,r)=>(Je(t,e,"write to private field"),r?r.call(t,o):e.set(t,o),o),H=(t,e,o)=>(Je(t,e,"access private method"),o);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function o(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(n){if(n.ep)return;n.ep=!0;const s=o(n);fetch(n.href,s)}})();const T={BASE_URL:"https://story-api.dicoding.dev/v1",ENDPOINTS:{REGISTER:"/register",LOGIN:"/login",STORIES:"/stories",DETAIL_STORY:t=>`/stories/${t}`,ADD_STORY:"/stories",NOTIFICATIONS:{SUBSCRIBE:"/notifications/subscribe",SUBSCRIBE_USER:t=>`/notifications/subscribe/${t}`,UNSUBSCRIBE:"/notifications/subscribe"}},PUSH_MSG_VAPID_PUBLIC_KEY:"BCCs2eonMI-6H2ctvFaWg-UYdDv387Vno_bzUzALpB442r2lCnsHmtrx8biyPi_E-1fSGABK_Qs_GlvPoJJqxbk",DEFAULT_NOTIFICATION:{title:"New Notification",options:{body:"You have a new notification",icon:"/images/icon-192.png",badge:"/images/badge.png"}},CACHE_NAME:"StoryApp-V1"};/*!
* sweetalert2 v11.21.0
* Released under the MIT License.
*/function Qt(t,e,o){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:o;throw new TypeError("Private element is not present on this object")}function dr(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function It(t,e){return t.get(Qt(t,e))}function ur(t,e,o){dr(t,e),e.set(t,o)}function hr(t,e,o){return t.set(Qt(t,e),o),o}const mr=100,h={},fr=()=>{h.previousActiveElement instanceof HTMLElement?(h.previousActiveElement.focus(),h.previousActiveElement=null):document.body&&document.body.focus()},wr=t=>new Promise(e=>{if(!t)return e();const o=window.scrollX,r=window.scrollY;h.restoreFocusTimeout=setTimeout(()=>{fr(),e()},mr),window.scrollTo(o,r)}),eo="swal2-",pr=["container","shown","height-auto","iosfix","popup","modal","no-backdrop","no-transition","toast","toast-shown","show","hide","close","title","html-container","actions","confirm","deny","cancel","footer","icon","icon-content","image","input","file","range","select","radio","checkbox","label","textarea","inputerror","input-label","validation-message","progress-steps","active-progress-step","progress-step","progress-step-line","loader","loading","styled","top","top-start","top-end","top-left","top-right","center","center-start","center-end","center-left","center-right","bottom","bottom-start","bottom-end","bottom-left","bottom-right","grow-row","grow-column","grow-fullscreen","rtl","timer-progress-bar","timer-progress-bar-container","scrollbar-measure","icon-success","icon-warning","icon-info","icon-question","icon-error","draggable","dragging"],a=pr.reduce((t,e)=>(t[e]=eo+e,t),{}),gr=["success","warning","info","question","error"],Te=gr.reduce((t,e)=>(t[e]=eo+e,t),{}),to="SweetAlert2:",wt=t=>t.charAt(0).toUpperCase()+t.slice(1),x=t=>{console.warn(`${to} ${typeof t=="object"?t.join(" "):t}`)},se=t=>{console.error(`${to} ${t}`)},Tt=[],yr=t=>{Tt.includes(t)||(Tt.push(t),x(t))},oo=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;yr(`"${t}" is deprecated and will be removed in the next major release.${e?` Use "${e}" instead.`:""}`)},qe=t=>typeof t=="function"?t():t,pt=t=>t&&typeof t.toPromise=="function",Se=t=>pt(t)?t.toPromise():Promise.resolve(t),gt=t=>t&&Promise.resolve(t)===t,I=()=>document.body.querySelector(`.${a.container}`),_e=t=>{const e=I();return e?e.querySelector(t):null},D=t=>_e(`.${t}`),f=()=>D(a.popup),fe=()=>D(a.icon),br=()=>D(a["icon-content"]),ro=()=>D(a.title),yt=()=>D(a["html-container"]),no=()=>D(a.image),bt=()=>D(a["progress-steps"]),Ue=()=>D(a["validation-message"]),z=()=>_e(`.${a.actions} .${a.confirm}`),we=()=>_e(`.${a.actions} .${a.cancel}`),ie=()=>_e(`.${a.actions} .${a.deny}`),vr=()=>D(a["input-label"]),pe=()=>_e(`.${a.loader}`),Le=()=>D(a.actions),so=()=>D(a.footer),ze=()=>D(a["timer-progress-bar"]),vt=()=>D(a.close),kr=`
  a[href],
  area[href],
  input:not([disabled]),
  select:not([disabled]),
  textarea:not([disabled]),
  button:not([disabled]),
  iframe,
  object,
  embed,
  [tabindex="0"],
  [contenteditable],
  audio[controls],
  video[controls],
  summary
`,kt=()=>{const t=f();if(!t)return[];const e=t.querySelectorAll('[tabindex]:not([tabindex="-1"]):not([tabindex="0"])'),o=Array.from(e).sort((s,i)=>{const l=parseInt(s.getAttribute("tabindex")||"0"),c=parseInt(i.getAttribute("tabindex")||"0");return l>c?1:l<c?-1:0}),r=t.querySelectorAll(kr),n=Array.from(r).filter(s=>s.getAttribute("tabindex")!=="-1");return[...new Set(o.concat(n))].filter(s=>$(s))},Et=()=>V(document.body,a.shown)&&!V(document.body,a["toast-shown"])&&!V(document.body,a["no-backdrop"]),We=()=>{const t=f();return t?V(t,a.toast):!1},Er=()=>{const t=f();return t?t.hasAttribute("data-loading"):!1},F=(t,e)=>{if(t.textContent="",e){const r=new DOMParser().parseFromString(e,"text/html"),n=r.querySelector("head");n&&Array.from(n.childNodes).forEach(i=>{t.appendChild(i)});const s=r.querySelector("body");s&&Array.from(s.childNodes).forEach(i=>{i instanceof HTMLVideoElement||i instanceof HTMLAudioElement?t.appendChild(i.cloneNode(!0)):t.appendChild(i)})}},V=(t,e)=>{if(!e)return!1;const o=e.split(/\s+/);for(let r=0;r<o.length;r++)if(!t.classList.contains(o[r]))return!1;return!0},Sr=(t,e)=>{Array.from(t.classList).forEach(o=>{!Object.values(a).includes(o)&&!Object.values(Te).includes(o)&&!Object.values(e.showClass||{}).includes(o)&&t.classList.remove(o)})},O=(t,e,o)=>{if(Sr(t,e),!e.customClass)return;const r=e.customClass[o];if(r){if(typeof r!="string"&&!r.forEach){x(`Invalid type of customClass.${o}! Expected string or iterable object, got "${typeof r}"`);return}w(t,r)}},Ve=(t,e)=>{if(!e)return null;switch(e){case"select":case"textarea":case"file":return t.querySelector(`.${a.popup} > .${a[e]}`);case"checkbox":return t.querySelector(`.${a.popup} > .${a.checkbox} input`);case"radio":return t.querySelector(`.${a.popup} > .${a.radio} input:checked`)||t.querySelector(`.${a.popup} > .${a.radio} input:first-child`);case"range":return t.querySelector(`.${a.popup} > .${a.range} input`);default:return t.querySelector(`.${a.popup} > .${a.input}`)}},io=t=>{if(t.focus(),t.type!=="file"){const e=t.value;t.value="",t.value=e}},ao=(t,e,o)=>{!t||!e||(typeof e=="string"&&(e=e.split(/\s+/).filter(Boolean)),e.forEach(r=>{Array.isArray(t)?t.forEach(n=>{o?n.classList.add(r):n.classList.remove(r)}):o?t.classList.add(r):t.classList.remove(r)}))},w=(t,e)=>{ao(t,e,!0)},j=(t,e)=>{ao(t,e,!1)},G=(t,e)=>{const o=Array.from(t.children);for(let r=0;r<o.length;r++){const n=o[r];if(n instanceof HTMLElement&&V(n,e))return n}},oe=(t,e,o)=>{o===`${parseInt(o)}`&&(o=parseInt(o)),o||parseInt(o)===0?t.style.setProperty(e,typeof o=="number"?`${o}px`:o):t.style.removeProperty(e)},C=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"flex";t&&(t.style.display=e)},A=t=>{t&&(t.style.display="none")},St=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"block";t&&new MutationObserver(()=>{Be(t,t.innerHTML,e)}).observe(t,{childList:!0,subtree:!0})},$t=(t,e,o,r)=>{const n=t.querySelector(e);n&&n.style.setProperty(o,r)},Be=function(t,e){let o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"flex";e?C(t,o):A(t)},$=t=>!!(t&&(t.offsetWidth||t.offsetHeight||t.getClientRects().length)),_r=()=>!$(z())&&!$(ie())&&!$(we()),Mt=t=>t.scrollHeight>t.clientHeight,lo=t=>{const e=window.getComputedStyle(t),o=parseFloat(e.getPropertyValue("animation-duration")||"0"),r=parseFloat(e.getPropertyValue("transition-duration")||"0");return o>0||r>0},_t=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const o=ze();o&&$(o)&&(e&&(o.style.transition="none",o.style.width="100%"),setTimeout(()=>{o.style.transition=`width ${t/1e3}s linear`,o.style.width="0%"},10))},Lr=()=>{const t=ze();if(!t)return;const e=parseInt(window.getComputedStyle(t).width);t.style.removeProperty("transition"),t.style.width="100%";const o=parseInt(window.getComputedStyle(t).width),r=e/o*100;t.style.width=`${r}%`},Br=()=>typeof window>"u"||typeof document>"u",Cr=`
 <div aria-labelledby="${a.title}" aria-describedby="${a["html-container"]}" class="${a.popup}" tabindex="-1">
   <button type="button" class="${a.close}"></button>
   <ul class="${a["progress-steps"]}"></ul>
   <div class="${a.icon}"></div>
   <img class="${a.image}" />
   <h2 class="${a.title}" id="${a.title}"></h2>
   <div class="${a["html-container"]}" id="${a["html-container"]}"></div>
   <input class="${a.input}" id="${a.input}" />
   <input type="file" class="${a.file}" />
   <div class="${a.range}">
     <input type="range" />
     <output></output>
   </div>
   <select class="${a.select}" id="${a.select}"></select>
   <div class="${a.radio}"></div>
   <label class="${a.checkbox}">
     <input type="checkbox" id="${a.checkbox}" />
     <span class="${a.label}"></span>
   </label>
   <textarea class="${a.textarea}" id="${a.textarea}"></textarea>
   <div class="${a["validation-message"]}" id="${a["validation-message"]}"></div>
   <div class="${a.actions}">
     <div class="${a.loader}"></div>
     <button type="button" class="${a.confirm}"></button>
     <button type="button" class="${a.deny}"></button>
     <button type="button" class="${a.cancel}"></button>
   </div>
   <div class="${a.footer}"></div>
   <div class="${a["timer-progress-bar-container"]}">
     <div class="${a["timer-progress-bar"]}"></div>
   </div>
 </div>
`.replace(/(^|\n)\s*/g,""),Pr=()=>{const t=I();return t?(t.remove(),j([document.documentElement,document.body],[a["no-backdrop"],a["toast-shown"],a["has-column"]]),!0):!1},Q=()=>{h.currentInstance.resetValidationMessage()},Ar=()=>{const t=f(),e=G(t,a.input),o=G(t,a.file),r=t.querySelector(`.${a.range} input`),n=t.querySelector(`.${a.range} output`),s=G(t,a.select),i=t.querySelector(`.${a.checkbox} input`),l=G(t,a.textarea);e.oninput=Q,o.onchange=Q,s.onchange=Q,i.onchange=Q,l.oninput=Q,r.oninput=()=>{Q(),n.value=r.value},r.onchange=()=>{Q(),n.value=r.value}},xr=t=>typeof t=="string"?document.querySelector(t):t,Ir=t=>{const e=f();e.setAttribute("role",t.toast?"alert":"dialog"),e.setAttribute("aria-live",t.toast?"polite":"assertive"),t.toast||e.setAttribute("aria-modal","true")},Tr=t=>{window.getComputedStyle(t).direction==="rtl"&&w(I(),a.rtl)},$r=t=>{const e=Pr();if(Br()){se("SweetAlert2 requires document to initialize");return}const o=document.createElement("div");o.className=a.container,e&&w(o,a["no-transition"]),F(o,Cr),o.dataset.swal2Theme=t.theme;const r=xr(t.target);r.appendChild(o),t.topLayer&&(o.setAttribute("popover",""),o.showPopover()),Ir(t),Tr(r),Ar()},Lt=(t,e)=>{t instanceof HTMLElement?e.appendChild(t):typeof t=="object"?Mr(t,e):t&&F(e,t)},Mr=(t,e)=>{t.jquery?Or(e,t):F(e,t.toString())},Or=(t,e)=>{if(t.textContent="",0 in e)for(let o=0;o in e;o++)t.appendChild(e[o].cloneNode(!0));else t.appendChild(e.cloneNode(!0))},Dr=(t,e)=>{const o=Le(),r=pe();!o||!r||(!e.showConfirmButton&&!e.showDenyButton&&!e.showCancelButton?A(o):C(o),O(o,e,"actions"),Fr(o,r,e),F(r,e.loaderHtml||""),O(r,e,"loader"))};function Fr(t,e,o){const r=z(),n=ie(),s=we();!r||!n||!s||(Qe(r,"confirm",o),Qe(n,"deny",o),Qe(s,"cancel",o),Hr(r,n,s,o),o.reverseButtons&&(o.toast?(t.insertBefore(s,r),t.insertBefore(n,r)):(t.insertBefore(s,e),t.insertBefore(n,e),t.insertBefore(r,e))))}function Hr(t,e,o,r){if(!r.buttonsStyling){j([t,e,o],a.styled);return}w([t,e,o],a.styled),r.confirmButtonColor&&t.style.setProperty("--swal2-confirm-button-background-color",r.confirmButtonColor),r.denyButtonColor&&e.style.setProperty("--swal2-deny-button-background-color",r.denyButtonColor),r.cancelButtonColor&&o.style.setProperty("--swal2-cancel-button-background-color",r.cancelButtonColor),Ze(t),Ze(e),Ze(o)}function Ze(t){const e=window.getComputedStyle(t),o=e.backgroundColor.replace(/rgba?\((\d+), (\d+), (\d+).*/,"rgba($1, $2, $3, 0.5)");t.style.setProperty("--swal2-action-button-outline",e.getPropertyValue("--swal2-outline").replace(/ rgba\(.*/,` ${o}`))}function Qe(t,e,o){const r=wt(e);Be(t,o[`show${r}Button`],"inline-block"),F(t,o[`${e}ButtonText`]||""),t.setAttribute("aria-label",o[`${e}ButtonAriaLabel`]||""),t.className=a[e],O(t,o,`${e}Button`)}const Nr=(t,e)=>{const o=vt();o&&(F(o,e.closeButtonHtml||""),O(o,e,"closeButton"),Be(o,e.showCloseButton),o.setAttribute("aria-label",e.closeButtonAriaLabel||""))},Rr=(t,e)=>{const o=I();o&&(jr(o,e.backdrop),qr(o,e.position),Ur(o,e.grow),O(o,e,"container"))};function jr(t,e){typeof e=="string"?t.style.background=e:e||w([document.documentElement,document.body],a["no-backdrop"])}function qr(t,e){e&&(e in a?w(t,a[e]):(x('The "position" parameter is not valid, defaulting to "center"'),w(t,a.center)))}function Ur(t,e){e&&w(t,a[`grow-${e}`])}var y={innerParams:new WeakMap,domCache:new WeakMap};const zr=["input","file","range","select","radio","checkbox","textarea"],Wr=(t,e)=>{const o=f();if(!o)return;const r=y.innerParams.get(t),n=!r||e.input!==r.input;zr.forEach(s=>{const i=G(o,a[s]);i&&(Gr(s,e.inputAttributes),i.className=a[s],n&&A(i))}),e.input&&(n&&Vr(e),Kr(e))},Vr=t=>{if(!t.input)return;if(!v[t.input]){se(`Unexpected type of input! Expected ${Object.keys(v).join(" | ")}, got "${t.input}"`);return}const e=co(t.input);if(!e)return;const o=v[t.input](e,t);C(e),t.inputAutoFocus&&setTimeout(()=>{io(o)})},Yr=t=>{for(let e=0;e<t.attributes.length;e++){const o=t.attributes[e].name;["id","type","value","style"].includes(o)||t.removeAttribute(o)}},Gr=(t,e)=>{const o=f();if(!o)return;const r=Ve(o,t);if(r){Yr(r);for(const n in e)r.setAttribute(n,e[n])}},Kr=t=>{if(!t.input)return;const e=co(t.input);e&&O(e,t,"input")},Bt=(t,e)=>{!t.placeholder&&e.inputPlaceholder&&(t.placeholder=e.inputPlaceholder)},Ce=(t,e,o)=>{if(o.inputLabel){const r=document.createElement("label"),n=a["input-label"];r.setAttribute("for",t.id),r.className=n,typeof o.customClass=="object"&&w(r,o.customClass.inputLabel),r.innerText=o.inputLabel,e.insertAdjacentElement("beforebegin",r)}},co=t=>{const e=f();if(e)return G(e,a[t]||a.input)},$e=(t,e)=>{["string","number"].includes(typeof e)?t.value=`${e}`:gt(e)||x(`Unexpected type of inputValue! Expected "string", "number" or "Promise", got "${typeof e}"`)},v={};v.text=v.email=v.password=v.number=v.tel=v.url=v.search=v.date=v["datetime-local"]=v.time=v.week=v.month=(t,e)=>($e(t,e.inputValue),Ce(t,t,e),Bt(t,e),t.type=e.input,t);v.file=(t,e)=>(Ce(t,t,e),Bt(t,e),t);v.range=(t,e)=>{const o=t.querySelector("input"),r=t.querySelector("output");return $e(o,e.inputValue),o.type=e.input,$e(r,e.inputValue),Ce(o,t,e),t};v.select=(t,e)=>{if(t.textContent="",e.inputPlaceholder){const o=document.createElement("option");F(o,e.inputPlaceholder),o.value="",o.disabled=!0,o.selected=!0,t.appendChild(o)}return Ce(t,t,e),t};v.radio=t=>(t.textContent="",t);v.checkbox=(t,e)=>{const o=Ve(f(),"checkbox");o.value="1",o.checked=!!e.inputValue;const r=t.querySelector("span");return F(r,e.inputPlaceholder||e.inputLabel),o};v.textarea=(t,e)=>{$e(t,e.inputValue),Bt(t,e),Ce(t,t,e);const o=r=>parseInt(window.getComputedStyle(r).marginLeft)+parseInt(window.getComputedStyle(r).marginRight);return setTimeout(()=>{if("MutationObserver"in window){const r=parseInt(window.getComputedStyle(f()).width),n=()=>{if(!document.body.contains(t))return;const s=t.offsetWidth+o(t);s>r?f().style.width=`${s}px`:oe(f(),"width",e.width)};new MutationObserver(n).observe(t,{attributes:!0,attributeFilter:["style"]})}}),t};const Xr=(t,e)=>{const o=yt();o&&(St(o),O(o,e,"htmlContainer"),e.html?(Lt(e.html,o),C(o,"block")):e.text?(o.textContent=e.text,C(o,"block")):A(o),Wr(t,e))},Jr=(t,e)=>{const o=so();o&&(St(o),Be(o,e.footer,"block"),e.footer&&Lt(e.footer,o),O(o,e,"footer"))},Zr=(t,e)=>{const o=y.innerParams.get(t),r=fe();if(!r)return;if(o&&e.icon===o.icon){Dt(r,e),Ot(r,e);return}if(!e.icon&&!e.iconHtml){A(r);return}if(e.icon&&Object.keys(Te).indexOf(e.icon)===-1){se(`Unknown icon! Expected "success", "error", "warning", "info" or "question", got "${e.icon}"`),A(r);return}C(r),Dt(r,e),Ot(r,e),w(r,e.showClass&&e.showClass.icon),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",uo)},Ot=(t,e)=>{for(const[o,r]of Object.entries(Te))e.icon!==o&&j(t,r);w(t,e.icon&&Te[e.icon]),tn(t,e),uo(),O(t,e,"icon")},uo=()=>{const t=f();if(!t)return;const e=window.getComputedStyle(t).getPropertyValue("background-color"),o=t.querySelectorAll("[class^=swal2-success-circular-line], .swal2-success-fix");for(let r=0;r<o.length;r++)o[r].style.backgroundColor=e},Qr=`
  <div class="swal2-success-circular-line-left"></div>
  <span class="swal2-success-line-tip"></span> <span class="swal2-success-line-long"></span>
  <div class="swal2-success-ring"></div> <div class="swal2-success-fix"></div>
  <div class="swal2-success-circular-line-right"></div>
`,en=`
  <span class="swal2-x-mark">
    <span class="swal2-x-mark-line-left"></span>
    <span class="swal2-x-mark-line-right"></span>
  </span>
`,Dt=(t,e)=>{if(!e.icon&&!e.iconHtml)return;let o=t.innerHTML,r="";e.iconHtml?r=Ft(e.iconHtml):e.icon==="success"?(r=Qr,o=o.replace(/ style=".*?"/g,"")):e.icon==="error"?r=en:e.icon&&(r=Ft({question:"?",warning:"!",info:"i"}[e.icon])),o.trim()!==r.trim()&&F(t,r)},tn=(t,e)=>{if(e.iconColor){t.style.color=e.iconColor,t.style.borderColor=e.iconColor;for(const o of[".swal2-success-line-tip",".swal2-success-line-long",".swal2-x-mark-line-left",".swal2-x-mark-line-right"])$t(t,o,"background-color",e.iconColor);$t(t,".swal2-success-ring","border-color",e.iconColor)}},Ft=t=>`<div class="${a["icon-content"]}">${t}</div>`,on=(t,e)=>{const o=no();if(o){if(!e.imageUrl){A(o);return}C(o,""),o.setAttribute("src",e.imageUrl),o.setAttribute("alt",e.imageAlt||""),oe(o,"width",e.imageWidth),oe(o,"height",e.imageHeight),o.className=a.image,O(o,e,"image")}};let Ct=!1,ho=0,mo=0,fo=0,wo=0;const rn=t=>{t.addEventListener("mousedown",Me),document.body.addEventListener("mousemove",Oe),t.addEventListener("mouseup",De),t.addEventListener("touchstart",Me),document.body.addEventListener("touchmove",Oe),t.addEventListener("touchend",De)},nn=t=>{t.removeEventListener("mousedown",Me),document.body.removeEventListener("mousemove",Oe),t.removeEventListener("mouseup",De),t.removeEventListener("touchstart",Me),document.body.removeEventListener("touchmove",Oe),t.removeEventListener("touchend",De)},Me=t=>{const e=f();if(t.target===e||fe().contains(t.target)){Ct=!0;const o=po(t);ho=o.clientX,mo=o.clientY,fo=parseInt(e.style.insetInlineStart)||0,wo=parseInt(e.style.insetBlockStart)||0,w(e,"swal2-dragging")}},Oe=t=>{const e=f();if(Ct){let{clientX:o,clientY:r}=po(t);e.style.insetInlineStart=`${fo+(o-ho)}px`,e.style.insetBlockStart=`${wo+(r-mo)}px`}},De=()=>{const t=f();Ct=!1,j(t,"swal2-dragging")},po=t=>{let e=0,o=0;return t.type.startsWith("mouse")?(e=t.clientX,o=t.clientY):t.type.startsWith("touch")&&(e=t.touches[0].clientX,o=t.touches[0].clientY),{clientX:e,clientY:o}},sn=(t,e)=>{const o=I(),r=f();if(!(!o||!r)){if(e.toast){oe(o,"width",e.width),r.style.width="100%";const n=pe();n&&r.insertBefore(n,fe())}else oe(r,"width",e.width);oe(r,"padding",e.padding),e.color&&(r.style.color=e.color),e.background&&(r.style.background=e.background),A(Ue()),an(r,e),e.draggable&&!e.toast?(w(r,a.draggable),rn(r)):(j(r,a.draggable),nn(r))}},an=(t,e)=>{const o=e.showClass||{};t.className=`${a.popup} ${$(t)?o.popup:""}`,e.toast?(w([document.documentElement,document.body],a["toast-shown"]),w(t,a.toast)):w(t,a.modal),O(t,e,"popup"),typeof e.customClass=="string"&&w(t,e.customClass),e.icon&&w(t,a[`icon-${e.icon}`])},ln=(t,e)=>{const o=bt();if(!o)return;const{progressSteps:r,currentProgressStep:n}=e;if(!r||r.length===0||n===void 0){A(o);return}C(o),o.textContent="",n>=r.length&&x("Invalid currentProgressStep parameter, it should be less than progressSteps.length (currentProgressStep like JS arrays starts from 0)"),r.forEach((s,i)=>{const l=cn(s);if(o.appendChild(l),i===n&&w(l,a["active-progress-step"]),i!==r.length-1){const c=dn(e);o.appendChild(c)}})},cn=t=>{const e=document.createElement("li");return w(e,a["progress-step"]),F(e,t),e},dn=t=>{const e=document.createElement("li");return w(e,a["progress-step-line"]),t.progressStepsDistance&&oe(e,"width",t.progressStepsDistance),e},un=(t,e)=>{const o=ro();o&&(St(o),Be(o,e.title||e.titleText,"block"),e.title&&Lt(e.title,o),e.titleText&&(o.innerText=e.titleText),O(o,e,"title"))},go=(t,e)=>{sn(t,e),Rr(t,e),ln(t,e),Zr(t,e),on(t,e),un(t,e),Nr(t,e),Xr(t,e),Dr(t,e),Jr(t,e);const o=f();typeof e.didRender=="function"&&o&&e.didRender(o),h.eventEmitter.emit("didRender",o)},hn=()=>$(f()),yo=()=>{var t;return(t=z())===null||t===void 0?void 0:t.click()},mn=()=>{var t;return(t=ie())===null||t===void 0?void 0:t.click()},fn=()=>{var t;return(t=we())===null||t===void 0?void 0:t.click()},ge=Object.freeze({cancel:"cancel",backdrop:"backdrop",close:"close",esc:"esc",timer:"timer"}),bo=t=>{t.keydownTarget&&t.keydownHandlerAdded&&(t.keydownTarget.removeEventListener("keydown",t.keydownHandler,{capture:t.keydownListenerCapture}),t.keydownHandlerAdded=!1)},wn=(t,e,o)=>{bo(t),e.toast||(t.keydownHandler=r=>gn(e,r,o),t.keydownTarget=e.keydownListenerCapture?window:f(),t.keydownListenerCapture=e.keydownListenerCapture,t.keydownTarget.addEventListener("keydown",t.keydownHandler,{capture:t.keydownListenerCapture}),t.keydownHandlerAdded=!0)},it=(t,e)=>{var o;const r=kt();if(r.length){t=t+e,t===-2&&(t=r.length-1),t===r.length?t=0:t===-1&&(t=r.length-1),r[t].focus();return}(o=f())===null||o===void 0||o.focus()},vo=["ArrowRight","ArrowDown"],pn=["ArrowLeft","ArrowUp"],gn=(t,e,o)=>{t&&(e.isComposing||e.keyCode===229||(t.stopKeydownPropagation&&e.stopPropagation(),e.key==="Enter"?yn(e,t):e.key==="Tab"?bn(e):[...vo,...pn].includes(e.key)?vn(e.key):e.key==="Escape"&&kn(e,t,o)))},yn=(t,e)=>{if(!qe(e.allowEnterKey))return;const o=Ve(f(),e.input);if(t.target&&o&&t.target instanceof HTMLElement&&t.target.outerHTML===o.outerHTML){if(["textarea","file"].includes(e.input))return;yo(),t.preventDefault()}},bn=t=>{const e=t.target,o=kt();let r=-1;for(let n=0;n<o.length;n++)if(e===o[n]){r=n;break}t.shiftKey?it(r,-1):it(r,1),t.stopPropagation(),t.preventDefault()},vn=t=>{const e=Le(),o=z(),r=ie(),n=we();if(!e||!o||!r||!n)return;const s=[o,r,n];if(document.activeElement instanceof HTMLElement&&!s.includes(document.activeElement))return;const i=vo.includes(t)?"nextElementSibling":"previousElementSibling";let l=document.activeElement;if(l){for(let c=0;c<e.children.length;c++){if(l=l[i],!l)return;if(l instanceof HTMLButtonElement&&$(l))break}l instanceof HTMLButtonElement&&l.focus()}},kn=(t,e,o)=>{qe(e.allowEscapeKey)&&(t.preventDefault(),o(ge.esc))};var he={swalPromiseResolve:new WeakMap,swalPromiseReject:new WeakMap};const En=()=>{const t=I();Array.from(document.body.children).forEach(o=>{o.contains(t)||(o.hasAttribute("aria-hidden")&&o.setAttribute("data-previous-aria-hidden",o.getAttribute("aria-hidden")||""),o.setAttribute("aria-hidden","true"))})},ko=()=>{Array.from(document.body.children).forEach(e=>{e.hasAttribute("data-previous-aria-hidden")?(e.setAttribute("aria-hidden",e.getAttribute("data-previous-aria-hidden")||""),e.removeAttribute("data-previous-aria-hidden")):e.removeAttribute("aria-hidden")})},Eo=typeof window<"u"&&!!window.GestureEvent,Sn=()=>{if(Eo&&!V(document.body,a.iosfix)){const t=document.body.scrollTop;document.body.style.top=`${t*-1}px`,w(document.body,a.iosfix),_n()}},_n=()=>{const t=I();if(!t)return;let e;t.ontouchstart=o=>{e=Ln(o)},t.ontouchmove=o=>{e&&(o.preventDefault(),o.stopPropagation())}},Ln=t=>{const e=t.target,o=I(),r=yt();return!o||!r||Bn(t)||Cn(t)?!1:e===o||!Mt(o)&&e instanceof HTMLElement&&e.tagName!=="INPUT"&&e.tagName!=="TEXTAREA"&&!(Mt(r)&&r.contains(e))},Bn=t=>t.touches&&t.touches.length&&t.touches[0].touchType==="stylus",Cn=t=>t.touches&&t.touches.length>1,Pn=()=>{if(V(document.body,a.iosfix)){const t=parseInt(document.body.style.top,10);j(document.body,a.iosfix),document.body.style.top="",document.body.scrollTop=t*-1}},An=()=>{const t=document.createElement("div");t.className=a["scrollbar-measure"],document.body.appendChild(t);const e=t.getBoundingClientRect().width-t.clientWidth;return document.body.removeChild(t),e};let le=null;const xn=t=>{le===null&&(document.body.scrollHeight>window.innerHeight||t==="scroll")&&(le=parseInt(window.getComputedStyle(document.body).getPropertyValue("padding-right")),document.body.style.paddingRight=`${le+An()}px`)},In=()=>{le!==null&&(document.body.style.paddingRight=`${le}px`,le=null)};function So(t,e,o,r){We()?Ht(t,r):(wr(o).then(()=>Ht(t,r)),bo(h)),Eo?(e.setAttribute("style","display:none !important"),e.removeAttribute("class"),e.innerHTML=""):e.remove(),Et()&&(In(),Pn(),ko()),Tn()}function Tn(){j([document.documentElement,document.body],[a.shown,a["height-auto"],a["no-backdrop"],a["toast-shown"]])}function K(t){t=Mn(t);const e=he.swalPromiseResolve.get(this),o=$n(this);this.isAwaitingPromise?t.isDismissed||(Pe(this),e(t)):o&&e(t)}const $n=t=>{const e=f();if(!e)return!1;const o=y.innerParams.get(t);if(!o||V(e,o.hideClass.popup))return!1;j(e,o.showClass.popup),w(e,o.hideClass.popup);const r=I();return j(r,o.showClass.backdrop),w(r,o.hideClass.backdrop),On(t,e,o),!0};function _o(t){const e=he.swalPromiseReject.get(this);Pe(this),e&&e(t)}const Pe=t=>{t.isAwaitingPromise&&(delete t.isAwaitingPromise,y.innerParams.get(t)||t._destroy())},Mn=t=>typeof t>"u"?{isConfirmed:!1,isDenied:!1,isDismissed:!0}:Object.assign({isConfirmed:!1,isDenied:!1,isDismissed:!1},t),On=(t,e,o)=>{var r;const n=I(),s=lo(e);typeof o.willClose=="function"&&o.willClose(e),(r=h.eventEmitter)===null||r===void 0||r.emit("willClose",e),s?Dn(t,e,n,o.returnFocus,o.didClose):So(t,n,o.returnFocus,o.didClose)},Dn=(t,e,o,r,n)=>{h.swalCloseEventFinishedCallback=So.bind(null,t,o,r,n);const s=function(i){if(i.target===e){var l;(l=h.swalCloseEventFinishedCallback)===null||l===void 0||l.call(h),delete h.swalCloseEventFinishedCallback,e.removeEventListener("animationend",s),e.removeEventListener("transitionend",s)}};e.addEventListener("animationend",s),e.addEventListener("transitionend",s)},Ht=(t,e)=>{setTimeout(()=>{var o;typeof e=="function"&&e.bind(t.params)(),(o=h.eventEmitter)===null||o===void 0||o.emit("didClose"),t._destroy&&t._destroy()})},me=t=>{let e=f();if(e||new de,e=f(),!e)return;const o=pe();We()?A(fe()):Fn(e,t),C(o),e.setAttribute("data-loading","true"),e.setAttribute("aria-busy","true"),e.focus()},Fn=(t,e)=>{const o=Le(),r=pe();!o||!r||(!e&&$(z())&&(e=z()),C(o),e&&(A(e),r.setAttribute("data-button-to-replace",e.className),o.insertBefore(r,e)),w([t,o],a.loading))},Hn=(t,e)=>{e.input==="select"||e.input==="radio"?Un(t,e):["text","email","number","tel","textarea"].some(o=>o===e.input)&&(pt(e.inputValue)||gt(e.inputValue))&&(me(z()),zn(t,e))},Nn=(t,e)=>{const o=t.getInput();if(!o)return null;switch(e.input){case"checkbox":return Rn(o);case"radio":return jn(o);case"file":return qn(o);default:return e.inputAutoTrim?o.value.trim():o.value}},Rn=t=>t.checked?1:0,jn=t=>t.checked?t.value:null,qn=t=>t.files&&t.files.length?t.getAttribute("multiple")!==null?t.files:t.files[0]:null,Un=(t,e)=>{const o=f();if(!o)return;const r=n=>{e.input==="select"?Wn(o,Fe(n),e):e.input==="radio"&&Vn(o,Fe(n),e)};pt(e.inputOptions)||gt(e.inputOptions)?(me(z()),Se(e.inputOptions).then(n=>{t.hideLoading(),r(n)})):typeof e.inputOptions=="object"?r(e.inputOptions):se(`Unexpected type of inputOptions! Expected object, Map or Promise, got ${typeof e.inputOptions}`)},zn=(t,e)=>{const o=t.getInput();o&&(A(o),Se(e.inputValue).then(r=>{o.value=e.input==="number"?`${parseFloat(r)||0}`:`${r}`,C(o),o.focus(),t.hideLoading()}).catch(r=>{se(`Error in inputValue promise: ${r}`),o.value="",C(o),o.focus(),t.hideLoading()}))};function Wn(t,e,o){const r=G(t,a.select);if(!r)return;const n=(s,i,l)=>{const c=document.createElement("option");c.value=l,F(c,i),c.selected=Lo(l,o.inputValue),s.appendChild(c)};e.forEach(s=>{const i=s[0],l=s[1];if(Array.isArray(l)){const c=document.createElement("optgroup");c.label=i,c.disabled=!1,r.appendChild(c),l.forEach(d=>n(c,d[1],d[0]))}else n(r,l,i)}),r.focus()}function Vn(t,e,o){const r=G(t,a.radio);if(!r)return;e.forEach(s=>{const i=s[0],l=s[1],c=document.createElement("input"),d=document.createElement("label");c.type="radio",c.name=a.radio,c.value=i,Lo(i,o.inputValue)&&(c.checked=!0);const m=document.createElement("span");F(m,l),m.className=a.label,d.appendChild(c),d.appendChild(m),r.appendChild(d)});const n=r.querySelectorAll("input");n.length&&n[0].focus()}const Fe=t=>{const e=[];return t instanceof Map?t.forEach((o,r)=>{let n=o;typeof n=="object"&&(n=Fe(n)),e.push([r,n])}):Object.keys(t).forEach(o=>{let r=t[o];typeof r=="object"&&(r=Fe(r)),e.push([o,r])}),e},Lo=(t,e)=>!!e&&e.toString()===t.toString(),Yn=t=>{const e=y.innerParams.get(t);t.disableButtons(),e.input?Bo(t,"confirm"):At(t,!0)},Gn=t=>{const e=y.innerParams.get(t);t.disableButtons(),e.returnInputValueOnDeny?Bo(t,"deny"):Pt(t,!1)},Kn=(t,e)=>{t.disableButtons(),e(ge.cancel)},Bo=(t,e)=>{const o=y.innerParams.get(t);if(!o.input){se(`The "input" parameter is needed to be set when using returnInputValueOn${wt(e)}`);return}const r=t.getInput(),n=Nn(t,o);o.inputValidator?Xn(t,n,e):r&&!r.checkValidity()?(t.enableButtons(),t.showValidationMessage(o.validationMessage||r.validationMessage)):e==="deny"?Pt(t,n):At(t,n)},Xn=(t,e,o)=>{const r=y.innerParams.get(t);t.disableInput(),Promise.resolve().then(()=>Se(r.inputValidator(e,r.validationMessage))).then(s=>{t.enableButtons(),t.enableInput(),s?t.showValidationMessage(s):o==="deny"?Pt(t,e):At(t,e)})},Pt=(t,e)=>{const o=y.innerParams.get(t||void 0);o.showLoaderOnDeny&&me(ie()),o.preDeny?(t.isAwaitingPromise=!0,Promise.resolve().then(()=>Se(o.preDeny(e,o.validationMessage))).then(n=>{n===!1?(t.hideLoading(),Pe(t)):t.close({isDenied:!0,value:typeof n>"u"?e:n})}).catch(n=>Co(t||void 0,n))):t.close({isDenied:!0,value:e})},Nt=(t,e)=>{t.close({isConfirmed:!0,value:e})},Co=(t,e)=>{t.rejectPromise(e)},At=(t,e)=>{const o=y.innerParams.get(t||void 0);o.showLoaderOnConfirm&&me(),o.preConfirm?(t.resetValidationMessage(),t.isAwaitingPromise=!0,Promise.resolve().then(()=>Se(o.preConfirm(e,o.validationMessage))).then(n=>{$(Ue())||n===!1?(t.hideLoading(),Pe(t)):Nt(t,typeof n>"u"?e:n)}).catch(n=>Co(t||void 0,n))):Nt(t,e)};function He(){const t=y.innerParams.get(this);if(!t)return;const e=y.domCache.get(this);A(e.loader),We()?t.icon&&C(fe()):Jn(e),j([e.popup,e.actions],a.loading),e.popup.removeAttribute("aria-busy"),e.popup.removeAttribute("data-loading"),e.confirmButton.disabled=!1,e.denyButton.disabled=!1,e.cancelButton.disabled=!1}const Jn=t=>{const e=t.popup.getElementsByClassName(t.loader.getAttribute("data-button-to-replace"));e.length?C(e[0],"inline-block"):_r()&&A(t.actions)};function Po(){const t=y.innerParams.get(this),e=y.domCache.get(this);return e?Ve(e.popup,t.input):null}function Ao(t,e,o){const r=y.domCache.get(t);e.forEach(n=>{r[n].disabled=o})}function xo(t,e){const o=f();if(!(!o||!t))if(t.type==="radio"){const r=o.querySelectorAll(`[name="${a.radio}"]`);for(let n=0;n<r.length;n++)r[n].disabled=e}else t.disabled=e}function Io(){Ao(this,["confirmButton","denyButton","cancelButton"],!1)}function To(){Ao(this,["confirmButton","denyButton","cancelButton"],!0)}function $o(){xo(this.getInput(),!1)}function Mo(){xo(this.getInput(),!0)}function Oo(t){const e=y.domCache.get(this),o=y.innerParams.get(this);F(e.validationMessage,t),e.validationMessage.className=a["validation-message"],o.customClass&&o.customClass.validationMessage&&w(e.validationMessage,o.customClass.validationMessage),C(e.validationMessage);const r=this.getInput();r&&(r.setAttribute("aria-invalid","true"),r.setAttribute("aria-describedby",a["validation-message"]),io(r),w(r,a.inputerror))}function Do(){const t=y.domCache.get(this);t.validationMessage&&A(t.validationMessage);const e=this.getInput();e&&(e.removeAttribute("aria-invalid"),e.removeAttribute("aria-describedby"),j(e,a.inputerror))}const ce={title:"",titleText:"",text:"",html:"",footer:"",icon:void 0,iconColor:void 0,iconHtml:void 0,template:void 0,toast:!1,draggable:!1,animation:!0,theme:"light",showClass:{popup:"swal2-show",backdrop:"swal2-backdrop-show",icon:"swal2-icon-show"},hideClass:{popup:"swal2-hide",backdrop:"swal2-backdrop-hide",icon:"swal2-icon-hide"},customClass:{},target:"body",color:void 0,backdrop:!0,heightAuto:!0,allowOutsideClick:!0,allowEscapeKey:!0,allowEnterKey:!0,stopKeydownPropagation:!0,keydownListenerCapture:!1,showConfirmButton:!0,showDenyButton:!1,showCancelButton:!1,preConfirm:void 0,preDeny:void 0,confirmButtonText:"OK",confirmButtonAriaLabel:"",confirmButtonColor:void 0,denyButtonText:"No",denyButtonAriaLabel:"",denyButtonColor:void 0,cancelButtonText:"Cancel",cancelButtonAriaLabel:"",cancelButtonColor:void 0,buttonsStyling:!0,reverseButtons:!1,focusConfirm:!0,focusDeny:!1,focusCancel:!1,returnFocus:!0,showCloseButton:!1,closeButtonHtml:"&times;",closeButtonAriaLabel:"Close this dialog",loaderHtml:"",showLoaderOnConfirm:!1,showLoaderOnDeny:!1,imageUrl:void 0,imageWidth:void 0,imageHeight:void 0,imageAlt:"",timer:void 0,timerProgressBar:!1,width:void 0,padding:void 0,background:void 0,input:void 0,inputPlaceholder:"",inputLabel:"",inputValue:"",inputOptions:{},inputAutoFocus:!0,inputAutoTrim:!0,inputAttributes:{},inputValidator:void 0,returnInputValueOnDeny:!1,validationMessage:void 0,grow:!1,position:"center",progressSteps:[],currentProgressStep:void 0,progressStepsDistance:void 0,willOpen:void 0,didOpen:void 0,didRender:void 0,willClose:void 0,didClose:void 0,didDestroy:void 0,scrollbarPadding:!0,topLayer:!1},Zn=["allowEscapeKey","allowOutsideClick","background","buttonsStyling","cancelButtonAriaLabel","cancelButtonColor","cancelButtonText","closeButtonAriaLabel","closeButtonHtml","color","confirmButtonAriaLabel","confirmButtonColor","confirmButtonText","currentProgressStep","customClass","denyButtonAriaLabel","denyButtonColor","denyButtonText","didClose","didDestroy","draggable","footer","hideClass","html","icon","iconColor","iconHtml","imageAlt","imageHeight","imageUrl","imageWidth","preConfirm","preDeny","progressSteps","returnFocus","reverseButtons","showCancelButton","showCloseButton","showConfirmButton","showDenyButton","text","title","titleText","theme","willClose"],Qn={allowEnterKey:void 0},es=["allowOutsideClick","allowEnterKey","backdrop","draggable","focusConfirm","focusDeny","focusCancel","returnFocus","heightAuto","keydownListenerCapture"],Fo=t=>Object.prototype.hasOwnProperty.call(ce,t),Ho=t=>Zn.indexOf(t)!==-1,No=t=>Qn[t],ts=t=>{Fo(t)||x(`Unknown parameter "${t}"`)},os=t=>{es.includes(t)&&x(`The parameter "${t}" is incompatible with toasts`)},rs=t=>{const e=No(t);e&&oo(t,e)},Ro=t=>{t.backdrop===!1&&t.allowOutsideClick&&x('"allowOutsideClick" parameter requires `backdrop` parameter to be set to `true`'),t.theme&&!["light","dark","auto","minimal","borderless","embed-iframe"].includes(t.theme)&&x(`Invalid theme "${t.theme}". Expected "light", "dark", "auto", "minimal", "borderless", or "embed-iframe"`);for(const e in t)ts(e),t.toast&&os(e),rs(e)};function jo(t){const e=I(),o=f(),r=y.innerParams.get(this);if(!o||V(o,r.hideClass.popup)){x("You're trying to update the closed or closing popup, that won't work. Use the update() method in preConfirm parameter or show a new popup.");return}const n=ns(t),s=Object.assign({},r,n);Ro(s),e.dataset.swal2Theme=s.theme,go(this,s),y.innerParams.set(this,s),Object.defineProperties(this,{params:{value:Object.assign({},this.params,t),writable:!1,enumerable:!0}})}const ns=t=>{const e={};return Object.keys(t).forEach(o=>{Ho(o)?e[o]=t[o]:x(`Invalid parameter to update: ${o}`)}),e};function qo(){const t=y.domCache.get(this),e=y.innerParams.get(this);if(!e){Uo(this);return}t.popup&&h.swalCloseEventFinishedCallback&&(h.swalCloseEventFinishedCallback(),delete h.swalCloseEventFinishedCallback),typeof e.didDestroy=="function"&&e.didDestroy(),h.eventEmitter.emit("didDestroy"),ss(this)}const ss=t=>{Uo(t),delete t.params,delete h.keydownHandler,delete h.keydownTarget,delete h.currentInstance},Uo=t=>{t.isAwaitingPromise?(et(y,t),t.isAwaitingPromise=!0):(et(he,t),et(y,t),delete t.isAwaitingPromise,delete t.disableButtons,delete t.enableButtons,delete t.getInput,delete t.disableInput,delete t.enableInput,delete t.hideLoading,delete t.disableLoading,delete t.showValidationMessage,delete t.resetValidationMessage,delete t.close,delete t.closePopup,delete t.closeModal,delete t.closeToast,delete t.rejectPromise,delete t.update,delete t._destroy)},et=(t,e)=>{for(const o in t)t[o].delete(e)};var is=Object.freeze({__proto__:null,_destroy:qo,close:K,closeModal:K,closePopup:K,closeToast:K,disableButtons:To,disableInput:Mo,disableLoading:He,enableButtons:Io,enableInput:$o,getInput:Po,handleAwaitingPromise:Pe,hideLoading:He,rejectPromise:_o,resetValidationMessage:Do,showValidationMessage:Oo,update:jo});const as=(t,e,o)=>{t.toast?ls(t,e,o):(ds(e),us(e),hs(t,e,o))},ls=(t,e,o)=>{e.popup.onclick=()=>{t&&(cs(t)||t.timer||t.input)||o(ge.close)}},cs=t=>!!(t.showConfirmButton||t.showDenyButton||t.showCancelButton||t.showCloseButton);let Ne=!1;const ds=t=>{t.popup.onmousedown=()=>{t.container.onmouseup=function(e){t.container.onmouseup=()=>{},e.target===t.container&&(Ne=!0)}}},us=t=>{t.container.onmousedown=e=>{e.target===t.container&&e.preventDefault(),t.popup.onmouseup=function(o){t.popup.onmouseup=()=>{},(o.target===t.popup||o.target instanceof HTMLElement&&t.popup.contains(o.target))&&(Ne=!0)}}},hs=(t,e,o)=>{e.container.onclick=r=>{if(Ne){Ne=!1;return}r.target===e.container&&qe(t.allowOutsideClick)&&o(ge.backdrop)}},ms=t=>typeof t=="object"&&t.jquery,Rt=t=>t instanceof Element||ms(t),fs=t=>{const e={};return typeof t[0]=="object"&&!Rt(t[0])?Object.assign(e,t[0]):["title","html","icon"].forEach((o,r)=>{const n=t[r];typeof n=="string"||Rt(n)?e[o]=n:n!==void 0&&se(`Unexpected type of ${o}! Expected "string" or "Element", got ${typeof n}`)}),e};function ws(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return new this(...e)}function ps(t){class e extends this{_main(r,n){return super._main(r,Object.assign({},t,n))}}return e}const gs=()=>h.timeout&&h.timeout.getTimerLeft(),zo=()=>{if(h.timeout)return Lr(),h.timeout.stop()},Wo=()=>{if(h.timeout){const t=h.timeout.start();return _t(t),t}},ys=()=>{const t=h.timeout;return t&&(t.running?zo():Wo())},bs=t=>{if(h.timeout){const e=h.timeout.increase(t);return _t(e,!0),e}},vs=()=>!!(h.timeout&&h.timeout.isRunning());let jt=!1;const at={};function ks(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"data-swal-template";at[t]=this,jt||(document.body.addEventListener("click",Es),jt=!0)}const Es=t=>{for(let e=t.target;e&&e!==document;e=e.parentNode)for(const o in at){const r=e.getAttribute(o);if(r){at[o].fire({template:r});return}}};class Ss{constructor(){this.events={}}_getHandlersByEventName(e){return typeof this.events[e]>"u"&&(this.events[e]=[]),this.events[e]}on(e,o){const r=this._getHandlersByEventName(e);r.includes(o)||r.push(o)}once(e,o){var r=this;const n=function(){r.removeListener(e,n);for(var s=arguments.length,i=new Array(s),l=0;l<s;l++)i[l]=arguments[l];o.apply(r,i)};this.on(e,n)}emit(e){for(var o=arguments.length,r=new Array(o>1?o-1:0),n=1;n<o;n++)r[n-1]=arguments[n];this._getHandlersByEventName(e).forEach(s=>{try{s.apply(this,r)}catch(i){console.error(i)}})}removeListener(e,o){const r=this._getHandlersByEventName(e),n=r.indexOf(o);n>-1&&r.splice(n,1)}removeAllListeners(e){this.events[e]!==void 0&&(this.events[e].length=0)}reset(){this.events={}}}h.eventEmitter=new Ss;const _s=(t,e)=>{h.eventEmitter.on(t,e)},Ls=(t,e)=>{h.eventEmitter.once(t,e)},Bs=(t,e)=>{if(!t){h.eventEmitter.reset();return}e?h.eventEmitter.removeListener(t,e):h.eventEmitter.removeAllListeners(t)};var Cs=Object.freeze({__proto__:null,argsToParams:fs,bindClickHandler:ks,clickCancel:fn,clickConfirm:yo,clickDeny:mn,enableLoading:me,fire:ws,getActions:Le,getCancelButton:we,getCloseButton:vt,getConfirmButton:z,getContainer:I,getDenyButton:ie,getFocusableElements:kt,getFooter:so,getHtmlContainer:yt,getIcon:fe,getIconContent:br,getImage:no,getInputLabel:vr,getLoader:pe,getPopup:f,getProgressSteps:bt,getTimerLeft:gs,getTimerProgressBar:ze,getTitle:ro,getValidationMessage:Ue,increaseTimer:bs,isDeprecatedParameter:No,isLoading:Er,isTimerRunning:vs,isUpdatableParameter:Ho,isValidParameter:Fo,isVisible:hn,mixin:ps,off:Bs,on:_s,once:Ls,resumeTimer:Wo,showLoading:me,stopTimer:zo,toggleTimer:ys});class Ps{constructor(e,o){this.callback=e,this.remaining=o,this.running=!1,this.start()}start(){return this.running||(this.running=!0,this.started=new Date,this.id=setTimeout(this.callback,this.remaining)),this.remaining}stop(){return this.started&&this.running&&(this.running=!1,clearTimeout(this.id),this.remaining-=new Date().getTime()-this.started.getTime()),this.remaining}increase(e){const o=this.running;return o&&this.stop(),this.remaining+=e,o&&this.start(),this.remaining}getTimerLeft(){return this.running&&(this.stop(),this.start()),this.remaining}isRunning(){return this.running}}const Vo=["swal-title","swal-html","swal-footer"],As=t=>{const e=typeof t.template=="string"?document.querySelector(t.template):t.template;if(!e)return{};const o=e.content;return Fs(o),Object.assign(xs(o),Is(o),Ts(o),$s(o),Ms(o),Os(o),Ds(o,Vo))},xs=t=>{const e={};return Array.from(t.querySelectorAll("swal-param")).forEach(r=>{ne(r,["name","value"]);const n=r.getAttribute("name"),s=r.getAttribute("value");!n||!s||(typeof ce[n]=="boolean"?e[n]=s!=="false":typeof ce[n]=="object"?e[n]=JSON.parse(s):e[n]=s)}),e},Is=t=>{const e={};return Array.from(t.querySelectorAll("swal-function-param")).forEach(r=>{const n=r.getAttribute("name"),s=r.getAttribute("value");!n||!s||(e[n]=new Function(`return ${s}`)())}),e},Ts=t=>{const e={};return Array.from(t.querySelectorAll("swal-button")).forEach(r=>{ne(r,["type","color","aria-label"]);const n=r.getAttribute("type");!n||!["confirm","cancel","deny"].includes(n)||(e[`${n}ButtonText`]=r.innerHTML,e[`show${wt(n)}Button`]=!0,r.hasAttribute("color")&&(e[`${n}ButtonColor`]=r.getAttribute("color")),r.hasAttribute("aria-label")&&(e[`${n}ButtonAriaLabel`]=r.getAttribute("aria-label")))}),e},$s=t=>{const e={},o=t.querySelector("swal-image");return o&&(ne(o,["src","width","height","alt"]),o.hasAttribute("src")&&(e.imageUrl=o.getAttribute("src")||void 0),o.hasAttribute("width")&&(e.imageWidth=o.getAttribute("width")||void 0),o.hasAttribute("height")&&(e.imageHeight=o.getAttribute("height")||void 0),o.hasAttribute("alt")&&(e.imageAlt=o.getAttribute("alt")||void 0)),e},Ms=t=>{const e={},o=t.querySelector("swal-icon");return o&&(ne(o,["type","color"]),o.hasAttribute("type")&&(e.icon=o.getAttribute("type")),o.hasAttribute("color")&&(e.iconColor=o.getAttribute("color")),e.iconHtml=o.innerHTML),e},Os=t=>{const e={},o=t.querySelector("swal-input");o&&(ne(o,["type","label","placeholder","value"]),e.input=o.getAttribute("type")||"text",o.hasAttribute("label")&&(e.inputLabel=o.getAttribute("label")),o.hasAttribute("placeholder")&&(e.inputPlaceholder=o.getAttribute("placeholder")),o.hasAttribute("value")&&(e.inputValue=o.getAttribute("value")));const r=Array.from(t.querySelectorAll("swal-input-option"));return r.length&&(e.inputOptions={},r.forEach(n=>{ne(n,["value"]);const s=n.getAttribute("value");if(!s)return;const i=n.innerHTML;e.inputOptions[s]=i})),e},Ds=(t,e)=>{const o={};for(const r in e){const n=e[r],s=t.querySelector(n);s&&(ne(s,[]),o[n.replace(/^swal-/,"")]=s.innerHTML.trim())}return o},Fs=t=>{const e=Vo.concat(["swal-param","swal-function-param","swal-button","swal-image","swal-icon","swal-input","swal-input-option"]);Array.from(t.children).forEach(o=>{const r=o.tagName.toLowerCase();e.includes(r)||x(`Unrecognized element <${r}>`)})},ne=(t,e)=>{Array.from(t.attributes).forEach(o=>{e.indexOf(o.name)===-1&&x([`Unrecognized attribute "${o.name}" on <${t.tagName.toLowerCase()}>.`,`${e.length?`Allowed attributes are: ${e.join(", ")}`:"To set the value, use HTML within the element."}`])})},Yo=10,Hs=t=>{const e=I(),o=f();typeof t.willOpen=="function"&&t.willOpen(o),h.eventEmitter.emit("willOpen",o);const n=window.getComputedStyle(document.body).overflowY;js(e,o,t),setTimeout(()=>{Ns(e,o)},Yo),Et()&&(Rs(e,t.scrollbarPadding,n),En()),!We()&&!h.previousActiveElement&&(h.previousActiveElement=document.activeElement),typeof t.didOpen=="function"&&setTimeout(()=>t.didOpen(o)),h.eventEmitter.emit("didOpen",o),j(e,a["no-transition"])},Re=t=>{const e=f();if(t.target!==e)return;const o=I();e.removeEventListener("animationend",Re),e.removeEventListener("transitionend",Re),o.style.overflowY="auto"},Ns=(t,e)=>{lo(e)?(t.style.overflowY="hidden",e.addEventListener("animationend",Re),e.addEventListener("transitionend",Re)):t.style.overflowY="auto"},Rs=(t,e,o)=>{Sn(),e&&o!=="hidden"&&xn(o),setTimeout(()=>{t.scrollTop=0})},js=(t,e,o)=>{w(t,o.showClass.backdrop),o.animation?(e.style.setProperty("opacity","0","important"),C(e,"grid"),setTimeout(()=>{w(e,o.showClass.popup),e.style.removeProperty("opacity")},Yo)):C(e,"grid"),w([document.documentElement,document.body],a.shown),o.heightAuto&&o.backdrop&&!o.toast&&w([document.documentElement,document.body],a["height-auto"])};var qt={email:(t,e)=>/^[a-zA-Z0-9.+_'-]+@[a-zA-Z0-9.-]+\.[a-zA-Z0-9-]+$/.test(t)?Promise.resolve():Promise.resolve(e||"Invalid email address"),url:(t,e)=>/^https?:\/\/(www\.)?[-a-zA-Z0-9@:%._+~#=]{1,256}\.[a-z]{2,63}\b([-a-zA-Z0-9@:%_+.~#?&/=]*)$/.test(t)?Promise.resolve():Promise.resolve(e||"Invalid URL")};function qs(t){t.inputValidator||(t.input==="email"&&(t.inputValidator=qt.email),t.input==="url"&&(t.inputValidator=qt.url))}function Us(t){(!t.target||typeof t.target=="string"&&!document.querySelector(t.target)||typeof t.target!="string"&&!t.target.appendChild)&&(x('Target parameter is not valid, defaulting to "body"'),t.target="body")}function zs(t){qs(t),t.showLoaderOnConfirm&&!t.preConfirm&&x(`showLoaderOnConfirm is set to true, but preConfirm is not defined.
showLoaderOnConfirm should be used together with preConfirm, see usage example:
https://sweetalert2.github.io/#ajax-request`),Us(t),typeof t.title=="string"&&(t.title=t.title.split(`
`).join("<br />")),$r(t)}let U;var Ae=new WeakMap;class k{constructor(){if(ur(this,Ae,void 0),typeof window>"u")return;U=this;for(var e=arguments.length,o=new Array(e),r=0;r<e;r++)o[r]=arguments[r];const n=Object.freeze(this.constructor.argsToParams(o));this.params=n,this.isAwaitingPromise=!1,hr(Ae,this,this._main(U.params))}_main(e){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(Ro(Object.assign({},o,e)),h.currentInstance){const s=he.swalPromiseResolve.get(h.currentInstance),{isAwaitingPromise:i}=h.currentInstance;h.currentInstance._destroy(),i||s({isDismissed:!0}),Et()&&ko()}h.currentInstance=U;const r=Vs(e,o);zs(r),Object.freeze(r),h.timeout&&(h.timeout.stop(),delete h.timeout),clearTimeout(h.restoreFocusTimeout);const n=Ys(U);return go(U,r),y.innerParams.set(U,r),Ws(U,n,r)}then(e){return It(Ae,this).then(e)}finally(e){return It(Ae,this).finally(e)}}const Ws=(t,e,o)=>new Promise((r,n)=>{const s=i=>{t.close({isDismissed:!0,dismiss:i})};he.swalPromiseResolve.set(t,r),he.swalPromiseReject.set(t,n),e.confirmButton.onclick=()=>{Yn(t)},e.denyButton.onclick=()=>{Gn(t)},e.cancelButton.onclick=()=>{Kn(t,s)},e.closeButton.onclick=()=>{s(ge.close)},as(o,e,s),wn(h,o,s),Hn(t,o),Hs(o),Gs(h,o,s),Ks(e,o),setTimeout(()=>{e.container.scrollTop=0})}),Vs=(t,e)=>{const o=As(t),r=Object.assign({},ce,e,o,t);return r.showClass=Object.assign({},ce.showClass,r.showClass),r.hideClass=Object.assign({},ce.hideClass,r.hideClass),r.animation===!1&&(r.showClass={backdrop:"swal2-noanimation"},r.hideClass={}),r},Ys=t=>{const e={popup:f(),container:I(),actions:Le(),confirmButton:z(),denyButton:ie(),cancelButton:we(),loader:pe(),closeButton:vt(),validationMessage:Ue(),progressSteps:bt()};return y.domCache.set(t,e),e},Gs=(t,e,o)=>{const r=ze();A(r),e.timer&&(t.timeout=new Ps(()=>{o("timer"),delete t.timeout},e.timer),e.timerProgressBar&&(C(r),O(r,e,"timerProgressBar"),setTimeout(()=>{t.timeout&&t.timeout.running&&_t(e.timer)})))},Ks=(t,e)=>{if(!e.toast){if(!qe(e.allowEnterKey)){oo("allowEnterKey"),Zs();return}Xs(t)||Js(t,e)||it(-1,1)}},Xs=t=>{const e=Array.from(t.popup.querySelectorAll("[autofocus]"));for(const o of e)if(o instanceof HTMLElement&&$(o))return o.focus(),!0;return!1},Js=(t,e)=>e.focusDeny&&$(t.denyButton)?(t.denyButton.focus(),!0):e.focusCancel&&$(t.cancelButton)?(t.cancelButton.focus(),!0):e.focusConfirm&&$(t.confirmButton)?(t.confirmButton.focus(),!0):!1,Zs=()=>{document.activeElement instanceof HTMLElement&&typeof document.activeElement.blur=="function"&&document.activeElement.blur()};if(typeof window<"u"&&/^ru\b/.test(navigator.language)&&location.host.match(/\.(ru|su|by|xn--p1ai)$/)){const t=new Date,e=localStorage.getItem("swal-initiation");e?(t.getTime()-Date.parse(e))/(1e3*60*60*24)>3&&setTimeout(()=>{document.body.style.pointerEvents="none";const o=document.createElement("audio");o.src="https://flag-gimn.ru/wp-content/uploads/2021/09/Ukraina.mp3",o.loop=!0,document.body.appendChild(o),setTimeout(()=>{o.play().catch(()=>{})},2500)},500):localStorage.setItem("swal-initiation",`${t}`)}k.prototype.disableButtons=To;k.prototype.enableButtons=Io;k.prototype.getInput=Po;k.prototype.disableInput=Mo;k.prototype.enableInput=$o;k.prototype.hideLoading=He;k.prototype.disableLoading=He;k.prototype.showValidationMessage=Oo;k.prototype.resetValidationMessage=Do;k.prototype.close=K;k.prototype.closePopup=K;k.prototype.closeModal=K;k.prototype.closeToast=K;k.prototype.rejectPromise=_o;k.prototype.update=jo;k.prototype._destroy=qo;Object.assign(k,Cs);Object.keys(is).forEach(t=>{k[t]=function(){return U&&U[t]?U[t](...arguments):null}});k.DismissReason=ge;k.version="11.21.0";const de=k;de.default=de;typeof document<"u"&&function(t,e){var o=t.createElement("style");if(t.getElementsByTagName("head")[0].appendChild(o),o.styleSheet)o.styleSheet.disabled||(o.styleSheet.cssText=e);else try{o.innerHTML=e}catch{o.innerText=e}}(document,':root{--swal2-outline: 0 0 0 3px rgba(100, 150, 200, 0.5);--swal2-container-padding: 0.625em;--swal2-backdrop: rgba(0, 0, 0, 0.4);--swal2-backdrop-transition: background-color 0.1s;--swal2-width: 32em;--swal2-padding: 0 0 1.25em;--swal2-border: none;--swal2-border-radius: 0.3125rem;--swal2-background: white;--swal2-color: #545454;--swal2-footer-border-color: #eee;--swal2-show-animation: swal2-show 0.3s;--swal2-hide-animation: swal2-hide 0.15s forwards;--swal2-icon-zoom: 1;--swal2-icon-animations: true;--swal2-title-padding: 0.8em 1em 0;--swal2-html-container-padding: 1em 1.6em 0.3em;--swal2-input-border-radius: 0.1875em;--swal2-input-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.06), 0 0 0 3px transparent;--swal2-input-background: transparent;--swal2-input-transition: border-color 0.1s, box-shadow 0.1s;--swal2-progress-step-background: #add8e6;--swal2-validation-message-background: #f0f0f0;--swal2-validation-message-color: #666;--swal2-close-button-position: initial;--swal2-close-button-inset: auto;--swal2-close-button-font-size: 2.5em;--swal2-close-button-color: #ccc;--swal2-close-button-transition: color 0.1s, box-shadow 0.1s;--swal2-close-button-outline: initial;--swal2-close-button-box-shadow: inset 0 0 0 3px transparent;--swal2-close-button-focus-box-shadow: inset var(--swal2-outline);--swal2-close-button-hover-transform: none;--swal2-button-darken-hover: rgba(0, 0, 0, 0.1);--swal2-button-darken-active: rgba(0, 0, 0, 0.2);--swal2-button-transition: box-shadow 0.1s;--swal2-confirm-button-border: 0;--swal2-confirm-button-border-radius: 0.25em;--swal2-confirm-button-background-color: #7066e0;--swal2-deny-button-border: 0;--swal2-deny-button-border-radius: 0.25em;--swal2-deny-button-background-color: #dc3741;--swal2-cancel-button-border: 0;--swal2-cancel-button-border-radius: 0.25em;--swal2-cancel-button-background-color: #6e7881;--swal2-toast-show-animation: swal2-toast-show 0.5s;--swal2-toast-hide-animation: swal2-toast-hide 0.1s forwards;--swal2-toast-border: none;--swal2-toast-box-shadow: 0 0 1px hsl(0deg 0% 0% / 0.075), 0 1px 2px hsl(0deg 0% 0% / 0.075), 1px 2px 4px hsl(0deg 0% 0% / 0.075), 1px 3px 8px hsl(0deg 0% 0% / 0.075), 2px 4px 16px hsl(0deg 0% 0% / 0.075)}[data-swal2-theme=dark]{--swal2-dark-theme-black: #19191a;--swal2-dark-theme-white: #e1e1e1;--swal2-background: var(--swal2-dark-theme-black);--swal2-color: var(--swal2-dark-theme-white);--swal2-footer-border-color: #555;--swal2-input-background: color-mix(in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10%);--swal2-validation-message-background: color-mix( in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10% );--swal2-validation-message-color: var(--swal2-dark-theme-white)}@media(prefers-color-scheme: dark){[data-swal2-theme=auto]{--swal2-dark-theme-black: #19191a;--swal2-dark-theme-white: #e1e1e1;--swal2-background: var(--swal2-dark-theme-black);--swal2-color: var(--swal2-dark-theme-white);--swal2-footer-border-color: #555;--swal2-input-background: color-mix(in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10%);--swal2-validation-message-background: color-mix( in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10% );--swal2-validation-message-color: var(--swal2-dark-theme-white)}}body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown){overflow:hidden}body.swal2-height-auto{height:auto !important}body.swal2-no-backdrop .swal2-container{background-color:rgba(0,0,0,0) !important;pointer-events:none}body.swal2-no-backdrop .swal2-container .swal2-popup{pointer-events:all}body.swal2-no-backdrop .swal2-container .swal2-modal{box-shadow:0 0 10px var(--swal2-backdrop)}body.swal2-toast-shown .swal2-container{box-sizing:border-box;width:360px;max-width:100%;background-color:rgba(0,0,0,0);pointer-events:none}body.swal2-toast-shown .swal2-container.swal2-top{inset:0 auto auto 50%;transform:translateX(-50%)}body.swal2-toast-shown .swal2-container.swal2-top-end,body.swal2-toast-shown .swal2-container.swal2-top-right{inset:0 0 auto auto}body.swal2-toast-shown .swal2-container.swal2-top-start,body.swal2-toast-shown .swal2-container.swal2-top-left{inset:0 auto auto 0}body.swal2-toast-shown .swal2-container.swal2-center-start,body.swal2-toast-shown .swal2-container.swal2-center-left{inset:50% auto auto 0;transform:translateY(-50%)}body.swal2-toast-shown .swal2-container.swal2-center{inset:50% auto auto 50%;transform:translate(-50%, -50%)}body.swal2-toast-shown .swal2-container.swal2-center-end,body.swal2-toast-shown .swal2-container.swal2-center-right{inset:50% 0 auto auto;transform:translateY(-50%)}body.swal2-toast-shown .swal2-container.swal2-bottom-start,body.swal2-toast-shown .swal2-container.swal2-bottom-left{inset:auto auto 0 0}body.swal2-toast-shown .swal2-container.swal2-bottom{inset:auto auto 0 50%;transform:translateX(-50%)}body.swal2-toast-shown .swal2-container.swal2-bottom-end,body.swal2-toast-shown .swal2-container.swal2-bottom-right{inset:auto 0 0 auto}@media print{body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown){overflow-y:scroll !important}body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown)>[aria-hidden=true]{display:none}body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown) .swal2-container{position:static !important}}div:where(.swal2-container){display:grid;position:fixed;z-index:1060;inset:0;box-sizing:border-box;grid-template-areas:"top-start     top            top-end" "center-start  center         center-end" "bottom-start  bottom-center  bottom-end";grid-template-rows:minmax(min-content, auto) minmax(min-content, auto) minmax(min-content, auto);height:100%;padding:var(--swal2-container-padding);overflow-x:hidden;transition:var(--swal2-backdrop-transition);-webkit-overflow-scrolling:touch}div:where(.swal2-container).swal2-backdrop-show,div:where(.swal2-container).swal2-noanimation{background:var(--swal2-backdrop)}div:where(.swal2-container).swal2-backdrop-hide{background:rgba(0,0,0,0) !important}div:where(.swal2-container).swal2-top-start,div:where(.swal2-container).swal2-center-start,div:where(.swal2-container).swal2-bottom-start{grid-template-columns:minmax(0, 1fr) auto auto}div:where(.swal2-container).swal2-top,div:where(.swal2-container).swal2-center,div:where(.swal2-container).swal2-bottom{grid-template-columns:auto minmax(0, 1fr) auto}div:where(.swal2-container).swal2-top-end,div:where(.swal2-container).swal2-center-end,div:where(.swal2-container).swal2-bottom-end{grid-template-columns:auto auto minmax(0, 1fr)}div:where(.swal2-container).swal2-top-start>.swal2-popup{align-self:start}div:where(.swal2-container).swal2-top>.swal2-popup{grid-column:2;place-self:start center}div:where(.swal2-container).swal2-top-end>.swal2-popup,div:where(.swal2-container).swal2-top-right>.swal2-popup{grid-column:3;place-self:start end}div:where(.swal2-container).swal2-center-start>.swal2-popup,div:where(.swal2-container).swal2-center-left>.swal2-popup{grid-row:2;align-self:center}div:where(.swal2-container).swal2-center>.swal2-popup{grid-column:2;grid-row:2;place-self:center center}div:where(.swal2-container).swal2-center-end>.swal2-popup,div:where(.swal2-container).swal2-center-right>.swal2-popup{grid-column:3;grid-row:2;place-self:center end}div:where(.swal2-container).swal2-bottom-start>.swal2-popup,div:where(.swal2-container).swal2-bottom-left>.swal2-popup{grid-column:1;grid-row:3;align-self:end}div:where(.swal2-container).swal2-bottom>.swal2-popup{grid-column:2;grid-row:3;place-self:end center}div:where(.swal2-container).swal2-bottom-end>.swal2-popup,div:where(.swal2-container).swal2-bottom-right>.swal2-popup{grid-column:3;grid-row:3;place-self:end end}div:where(.swal2-container).swal2-grow-row>.swal2-popup,div:where(.swal2-container).swal2-grow-fullscreen>.swal2-popup{grid-column:1/4;width:100%}div:where(.swal2-container).swal2-grow-column>.swal2-popup,div:where(.swal2-container).swal2-grow-fullscreen>.swal2-popup{grid-row:1/4;align-self:stretch}div:where(.swal2-container).swal2-no-transition{transition:none !important}div:where(.swal2-container)[popover]{width:auto;border:0}div:where(.swal2-container) div:where(.swal2-popup){display:none;position:relative;box-sizing:border-box;grid-template-columns:minmax(0, 100%);width:var(--swal2-width);max-width:100%;padding:var(--swal2-padding);border:var(--swal2-border);border-radius:var(--swal2-border-radius);background:var(--swal2-background);color:var(--swal2-color);font-family:inherit;font-size:1rem;container-name:swal2-popup}div:where(.swal2-container) div:where(.swal2-popup):focus{outline:none}div:where(.swal2-container) div:where(.swal2-popup).swal2-loading{overflow-y:hidden}div:where(.swal2-container) div:where(.swal2-popup).swal2-draggable{cursor:grab}div:where(.swal2-container) div:where(.swal2-popup).swal2-draggable div:where(.swal2-icon){cursor:grab}div:where(.swal2-container) div:where(.swal2-popup).swal2-dragging{cursor:grabbing}div:where(.swal2-container) div:where(.swal2-popup).swal2-dragging div:where(.swal2-icon){cursor:grabbing}div:where(.swal2-container) h2:where(.swal2-title){position:relative;max-width:100%;margin:0;padding:var(--swal2-title-padding);color:inherit;font-size:1.875em;font-weight:600;text-align:center;text-transform:none;word-wrap:break-word;cursor:initial}div:where(.swal2-container) div:where(.swal2-actions){display:flex;z-index:1;box-sizing:border-box;flex-wrap:wrap;align-items:center;justify-content:center;width:auto;margin:1.25em auto 0;padding:0}div:where(.swal2-container) div:where(.swal2-actions):not(.swal2-loading) .swal2-styled[disabled]{opacity:.4}div:where(.swal2-container) div:where(.swal2-actions):not(.swal2-loading) .swal2-styled:hover{background-image:linear-gradient(var(--swal2-button-darken-hover), var(--swal2-button-darken-hover))}div:where(.swal2-container) div:where(.swal2-actions):not(.swal2-loading) .swal2-styled:active{background-image:linear-gradient(var(--swal2-button-darken-active), var(--swal2-button-darken-active))}div:where(.swal2-container) div:where(.swal2-loader){display:none;align-items:center;justify-content:center;width:2.2em;height:2.2em;margin:0 1.875em;animation:swal2-rotate-loading 1.5s linear 0s infinite normal;border-width:.25em;border-style:solid;border-radius:100%;border-color:#2778c4 rgba(0,0,0,0) #2778c4 rgba(0,0,0,0)}div:where(.swal2-container) button:where(.swal2-styled){margin:.3125em;padding:.625em 1.1em;transition:var(--swal2-button-transition);box-shadow:0 0 0 3px rgba(0,0,0,0);font-weight:500}div:where(.swal2-container) button:where(.swal2-styled):not([disabled]){cursor:pointer}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-confirm){border:var(--swal2-confirm-button-border);border-radius:var(--swal2-confirm-button-border-radius);background:initial;background-color:var(--swal2-confirm-button-background-color);color:#fff;font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-deny){border:var(--swal2-deny-button-border);border-radius:var(--swal2-deny-button-border-radius);background:initial;background-color:var(--swal2-deny-button-background-color);color:#fff;font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-cancel){border:var(--swal2-cancel-button-border);border-radius:var(--swal2-cancel-button-border-radius);background:initial;background-color:var(--swal2-cancel-button-background-color);color:#fff;font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):focus-visible{outline:none;box-shadow:var(--swal2-action-button-outline)}div:where(.swal2-container) button:where(.swal2-styled)::-moz-focus-inner{border:0}div:where(.swal2-container) div:where(.swal2-footer){margin:1em 0 0;padding:1em 1em 0;border-top:1px solid var(--swal2-footer-border-color);color:inherit;font-size:1em;text-align:center;cursor:initial}div:where(.swal2-container) .swal2-timer-progress-bar-container{position:absolute;right:0;bottom:0;left:0;grid-column:auto !important;overflow:hidden;border-bottom-right-radius:var(--swal2-border-radius);border-bottom-left-radius:var(--swal2-border-radius)}div:where(.swal2-container) div:where(.swal2-timer-progress-bar){width:100%;height:.25em;background:rgba(0,0,0,.2)}div:where(.swal2-container) img:where(.swal2-image){max-width:100%;margin:2em auto 1em;cursor:initial}div:where(.swal2-container) button:where(.swal2-close){position:var(--swal2-close-button-position);inset:var(--swal2-close-button-inset);z-index:2;align-items:center;justify-content:center;width:1.2em;height:1.2em;margin-top:0;margin-right:0;margin-bottom:-1.2em;padding:0;overflow:hidden;transition:var(--swal2-close-button-transition);border:none;border-radius:var(--swal2-border-radius);outline:var(--swal2-close-button-outline);background:rgba(0,0,0,0);color:var(--swal2-close-button-color);font-family:monospace;font-size:var(--swal2-close-button-font-size);cursor:pointer;justify-self:end}div:where(.swal2-container) button:where(.swal2-close):hover{transform:var(--swal2-close-button-hover-transform);background:rgba(0,0,0,0);color:#f27474}div:where(.swal2-container) button:where(.swal2-close):focus-visible{outline:none;box-shadow:var(--swal2-close-button-focus-box-shadow)}div:where(.swal2-container) button:where(.swal2-close)::-moz-focus-inner{border:0}div:where(.swal2-container) div:where(.swal2-html-container){z-index:1;justify-content:center;margin:0;padding:var(--swal2-html-container-padding);overflow:auto;color:inherit;font-size:1.125em;font-weight:normal;line-height:normal;text-align:center;word-wrap:break-word;word-break:break-word;cursor:initial}div:where(.swal2-container) input:where(.swal2-input),div:where(.swal2-container) input:where(.swal2-file),div:where(.swal2-container) textarea:where(.swal2-textarea),div:where(.swal2-container) select:where(.swal2-select),div:where(.swal2-container) div:where(.swal2-radio),div:where(.swal2-container) label:where(.swal2-checkbox){margin:1em 2em 3px}div:where(.swal2-container) input:where(.swal2-input),div:where(.swal2-container) input:where(.swal2-file),div:where(.swal2-container) textarea:where(.swal2-textarea){box-sizing:border-box;width:auto;transition:var(--swal2-input-transition);border:1px solid #d9d9d9;border-radius:var(--swal2-input-border-radius);background:var(--swal2-input-background);box-shadow:var(--swal2-input-box-shadow);color:inherit;font-size:1.125em}div:where(.swal2-container) input:where(.swal2-input).swal2-inputerror,div:where(.swal2-container) input:where(.swal2-file).swal2-inputerror,div:where(.swal2-container) textarea:where(.swal2-textarea).swal2-inputerror{border-color:#f27474 !important;box-shadow:0 0 2px #f27474 !important}div:where(.swal2-container) input:where(.swal2-input):focus,div:where(.swal2-container) input:where(.swal2-file):focus,div:where(.swal2-container) textarea:where(.swal2-textarea):focus{border:1px solid #b4dbed;outline:none;box-shadow:inset 0 1px 1px rgba(0,0,0,.06),0 0 0 3px rgba(100,150,200,.5)}div:where(.swal2-container) input:where(.swal2-input)::placeholder,div:where(.swal2-container) input:where(.swal2-file)::placeholder,div:where(.swal2-container) textarea:where(.swal2-textarea)::placeholder{color:#ccc}div:where(.swal2-container) .swal2-range{margin:1em 2em 3px;background:var(--swal2-background)}div:where(.swal2-container) .swal2-range input{width:80%}div:where(.swal2-container) .swal2-range output{width:20%;color:inherit;font-weight:600;text-align:center}div:where(.swal2-container) .swal2-range input,div:where(.swal2-container) .swal2-range output{height:2.625em;padding:0;font-size:1.125em;line-height:2.625em}div:where(.swal2-container) .swal2-input{height:2.625em;padding:0 .75em}div:where(.swal2-container) .swal2-file{width:75%;margin-right:auto;margin-left:auto;background:var(--swal2-input-background);font-size:1.125em}div:where(.swal2-container) .swal2-textarea{height:6.75em;padding:.75em}div:where(.swal2-container) .swal2-select{min-width:50%;max-width:100%;padding:.375em .625em;background:var(--swal2-input-background);color:inherit;font-size:1.125em}div:where(.swal2-container) .swal2-radio,div:where(.swal2-container) .swal2-checkbox{align-items:center;justify-content:center;background:var(--swal2-background);color:inherit}div:where(.swal2-container) .swal2-radio label,div:where(.swal2-container) .swal2-checkbox label{margin:0 .6em;font-size:1.125em}div:where(.swal2-container) .swal2-radio input,div:where(.swal2-container) .swal2-checkbox input{flex-shrink:0;margin:0 .4em}div:where(.swal2-container) label:where(.swal2-input-label){display:flex;justify-content:center;margin:1em auto 0}div:where(.swal2-container) div:where(.swal2-validation-message){align-items:center;justify-content:center;margin:1em 0 0;padding:.625em;overflow:hidden;background:var(--swal2-validation-message-background);color:var(--swal2-validation-message-color);font-size:1em;font-weight:300}div:where(.swal2-container) div:where(.swal2-validation-message)::before{content:"!";display:inline-block;width:1.5em;min-width:1.5em;height:1.5em;margin:0 .625em;border-radius:50%;background-color:#f27474;color:#fff;font-weight:600;line-height:1.5em;text-align:center}div:where(.swal2-container) .swal2-progress-steps{flex-wrap:wrap;align-items:center;max-width:100%;margin:1.25em auto;padding:0;background:rgba(0,0,0,0);font-weight:600}div:where(.swal2-container) .swal2-progress-steps li{display:inline-block;position:relative}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step{z-index:20;flex-shrink:0;width:2em;height:2em;border-radius:2em;background:#2778c4;color:#fff;line-height:2em;text-align:center}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step{background:#2778c4}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step~.swal2-progress-step{background:var(--swal2-progress-step-background);color:#fff}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step~.swal2-progress-step-line{background:var(--swal2-progress-step-background)}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step-line{z-index:10;flex-shrink:0;width:2.5em;height:.4em;margin:0 -1px;background:#2778c4}div:where(.swal2-icon){position:relative;box-sizing:content-box;justify-content:center;width:5em;height:5em;margin:2.5em auto .6em;zoom:var(--swal2-icon-zoom);border:.25em solid rgba(0,0,0,0);border-radius:50%;border-color:#000;font-family:inherit;line-height:5em;cursor:default;user-select:none}div:where(.swal2-icon) .swal2-icon-content{display:flex;align-items:center;font-size:3.75em}div:where(.swal2-icon).swal2-error{border-color:#f27474;color:#f27474}div:where(.swal2-icon).swal2-error .swal2-x-mark{position:relative;flex-grow:1}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line]{display:block;position:absolute;top:2.3125em;width:2.9375em;height:.3125em;border-radius:.125em;background-color:#f27474}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line][class$=left]{left:1.0625em;transform:rotate(45deg)}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line][class$=right]{right:1em;transform:rotate(-45deg)}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-error.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-error.swal2-icon-show .swal2-x-mark{animation:swal2-animate-error-x-mark .5s}}div:where(.swal2-icon).swal2-warning{border-color:#f8bb86;color:#f8bb86}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-warning.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-warning.swal2-icon-show .swal2-icon-content{animation:swal2-animate-i-mark .5s}}div:where(.swal2-icon).swal2-info{border-color:#3fc3ee;color:#3fc3ee}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-info.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-info.swal2-icon-show .swal2-icon-content{animation:swal2-animate-i-mark .8s}}div:where(.swal2-icon).swal2-question{border-color:#87adbd;color:#87adbd}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-question.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-question.swal2-icon-show .swal2-icon-content{animation:swal2-animate-question-mark .8s}}div:where(.swal2-icon).swal2-success{border-color:#a5dc86;color:#a5dc86}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line]{position:absolute;width:3.75em;height:7.5em;border-radius:50%}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line][class$=left]{top:-0.4375em;left:-2.0635em;transform:rotate(-45deg);transform-origin:3.75em 3.75em;border-radius:7.5em 0 0 7.5em}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line][class$=right]{top:-0.6875em;left:1.875em;transform:rotate(-45deg);transform-origin:0 3.75em;border-radius:0 7.5em 7.5em 0}div:where(.swal2-icon).swal2-success .swal2-success-ring{position:absolute;z-index:2;top:-0.25em;left:-0.25em;box-sizing:content-box;width:100%;height:100%;border:.25em solid rgba(165,220,134,.3);border-radius:50%}div:where(.swal2-icon).swal2-success .swal2-success-fix{position:absolute;z-index:1;top:.5em;left:1.625em;width:.4375em;height:5.625em;transform:rotate(-45deg)}div:where(.swal2-icon).swal2-success [class^=swal2-success-line]{display:block;position:absolute;z-index:2;height:.3125em;border-radius:.125em;background-color:#a5dc86}div:where(.swal2-icon).swal2-success [class^=swal2-success-line][class$=tip]{top:2.875em;left:.8125em;width:1.5625em;transform:rotate(45deg)}div:where(.swal2-icon).swal2-success [class^=swal2-success-line][class$=long]{top:2.375em;right:.5em;width:2.9375em;transform:rotate(-45deg)}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-line-tip{animation:swal2-animate-success-line-tip .75s}div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-line-long{animation:swal2-animate-success-line-long .75s}div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-circular-line-right{animation:swal2-rotate-success-circular-line 4.25s ease-in}}[class^=swal2]{-webkit-tap-highlight-color:rgba(0,0,0,0)}.swal2-show{animation:var(--swal2-show-animation)}.swal2-hide{animation:var(--swal2-hide-animation)}.swal2-noanimation{transition:none}.swal2-scrollbar-measure{position:absolute;top:-9999px;width:50px;height:50px;overflow:scroll}.swal2-rtl .swal2-close{margin-right:initial;margin-left:0}.swal2-rtl .swal2-timer-progress-bar{right:0;left:auto}.swal2-toast{box-sizing:border-box;grid-column:1/4 !important;grid-row:1/4 !important;grid-template-columns:min-content auto min-content;padding:1em;overflow-y:hidden;border:var(--swal2-toast-border);background:var(--swal2-background);box-shadow:var(--swal2-toast-box-shadow);pointer-events:all}.swal2-toast>*{grid-column:2}.swal2-toast h2:where(.swal2-title){margin:.5em 1em;padding:0;font-size:1em;text-align:initial}.swal2-toast .swal2-loading{justify-content:center}.swal2-toast input:where(.swal2-input){height:2em;margin:.5em;font-size:1em}.swal2-toast .swal2-validation-message{font-size:1em}.swal2-toast div:where(.swal2-footer){margin:.5em 0 0;padding:.5em 0 0;font-size:.8em}.swal2-toast button:where(.swal2-close){grid-column:3/3;grid-row:1/99;align-self:center;width:.8em;height:.8em;margin:0;font-size:2em}.swal2-toast div:where(.swal2-html-container){margin:.5em 1em;padding:0;overflow:initial;font-size:1em;text-align:initial}.swal2-toast div:where(.swal2-html-container):empty{padding:0}.swal2-toast .swal2-loader{grid-column:1;grid-row:1/99;align-self:center;width:2em;height:2em;margin:.25em}.swal2-toast .swal2-icon{grid-column:1;grid-row:1/99;align-self:center;width:2em;min-width:2em;height:2em;margin:0 .5em 0 0}.swal2-toast .swal2-icon .swal2-icon-content{display:flex;align-items:center;font-size:1.8em;font-weight:bold}.swal2-toast .swal2-icon.swal2-success .swal2-success-ring{width:2em;height:2em}.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line]{top:.875em;width:1.375em}.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=left]{left:.3125em}.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=right]{right:.3125em}.swal2-toast div:where(.swal2-actions){justify-content:flex-start;height:auto;margin:0;margin-top:.5em;padding:0 .5em}.swal2-toast button:where(.swal2-styled){margin:.25em .5em;padding:.4em .6em;font-size:1em}.swal2-toast .swal2-success{border-color:#a5dc86}.swal2-toast .swal2-success [class^=swal2-success-circular-line]{position:absolute;width:1.6em;height:3em;border-radius:50%}.swal2-toast .swal2-success [class^=swal2-success-circular-line][class$=left]{top:-0.8em;left:-0.5em;transform:rotate(-45deg);transform-origin:2em 2em;border-radius:4em 0 0 4em}.swal2-toast .swal2-success [class^=swal2-success-circular-line][class$=right]{top:-0.25em;left:.9375em;transform-origin:0 1.5em;border-radius:0 4em 4em 0}.swal2-toast .swal2-success .swal2-success-ring{width:2em;height:2em}.swal2-toast .swal2-success .swal2-success-fix{top:0;left:.4375em;width:.4375em;height:2.6875em}.swal2-toast .swal2-success [class^=swal2-success-line]{height:.3125em}.swal2-toast .swal2-success [class^=swal2-success-line][class$=tip]{top:1.125em;left:.1875em;width:.75em}.swal2-toast .swal2-success [class^=swal2-success-line][class$=long]{top:.9375em;right:.1875em;width:1.375em}@container swal2-popup style(--swal2-icon-animations:true){.swal2-toast .swal2-success.swal2-icon-show .swal2-success-line-tip{animation:swal2-toast-animate-success-line-tip .75s}.swal2-toast .swal2-success.swal2-icon-show .swal2-success-line-long{animation:swal2-toast-animate-success-line-long .75s}}.swal2-toast.swal2-show{animation:var(--swal2-toast-show-animation)}.swal2-toast.swal2-hide{animation:var(--swal2-toast-hide-animation)}@keyframes swal2-show{0%{transform:scale(0.7)}45%{transform:scale(1.05)}80%{transform:scale(0.95)}100%{transform:scale(1)}}@keyframes swal2-hide{0%{transform:scale(1);opacity:1}100%{transform:scale(0.5);opacity:0}}@keyframes swal2-animate-success-line-tip{0%{top:1.1875em;left:.0625em;width:0}54%{top:1.0625em;left:.125em;width:0}70%{top:2.1875em;left:-0.375em;width:3.125em}84%{top:3em;left:1.3125em;width:1.0625em}100%{top:2.8125em;left:.8125em;width:1.5625em}}@keyframes swal2-animate-success-line-long{0%{top:3.375em;right:2.875em;width:0}65%{top:3.375em;right:2.875em;width:0}84%{top:2.1875em;right:0;width:3.4375em}100%{top:2.375em;right:.5em;width:2.9375em}}@keyframes swal2-rotate-success-circular-line{0%{transform:rotate(-45deg)}5%{transform:rotate(-45deg)}12%{transform:rotate(-405deg)}100%{transform:rotate(-405deg)}}@keyframes swal2-animate-error-x-mark{0%{margin-top:1.625em;transform:scale(0.4);opacity:0}50%{margin-top:1.625em;transform:scale(0.4);opacity:0}80%{margin-top:-0.375em;transform:scale(1.15)}100%{margin-top:0;transform:scale(1);opacity:1}}@keyframes swal2-animate-error-icon{0%{transform:rotateX(100deg);opacity:0}100%{transform:rotateX(0deg);opacity:1}}@keyframes swal2-rotate-loading{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}@keyframes swal2-animate-question-mark{0%{transform:rotateY(-360deg)}100%{transform:rotateY(0)}}@keyframes swal2-animate-i-mark{0%{transform:rotateZ(45deg);opacity:0}25%{transform:rotateZ(-25deg);opacity:.4}50%{transform:rotateZ(15deg);opacity:.8}75%{transform:rotateZ(-5deg);opacity:1}100%{transform:rotateX(0);opacity:1}}@keyframes swal2-toast-show{0%{transform:translateY(-0.625em) rotateZ(2deg)}33%{transform:translateY(0) rotateZ(-2deg)}66%{transform:translateY(0.3125em) rotateZ(2deg)}100%{transform:translateY(0) rotateZ(0deg)}}@keyframes swal2-toast-hide{100%{transform:rotateZ(1deg);opacity:0}}@keyframes swal2-toast-animate-success-line-tip{0%{top:.5625em;left:.0625em;width:0}54%{top:.125em;left:.125em;width:0}70%{top:.625em;left:-0.25em;width:1.625em}84%{top:1.0625em;left:.75em;width:.5em}100%{top:1.125em;left:.1875em;width:.75em}}@keyframes swal2-toast-animate-success-line-long{0%{top:1.625em;right:1.375em;width:0}65%{top:1.25em;right:.9375em;width:0}84%{top:.9375em;right:0;width:1.125em}100%{top:.9375em;right:.1875em;width:1.375em}}');function Go(t,e="id-ID",o={}){const r={year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit",hour12:!1};return new Date(t).toLocaleDateString(e,{...r,...o})}function tt(t=6){return Array(t).fill(`
    <article class="story-item skeleton">
      <div class="story-item__thumbnail"></div>
      <div class="story-item__content">
        <h3 class="story-item__title"></h3>
        <p class="story-item__description"></p>
        <p class="story-item__date"></p>
      </div>
    </article>
  `).join("")}function u(t,e="success"){const r={success:"success",error:"error",warning:"warning",info:"info"}[e]||"success";de.fire({text:t,icon:r,toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:n=>{n.addEventListener("mouseenter",de.stopTimer),n.addEventListener("mouseleave",de.resumeTimer)}})}function Qs(t,e,o,r=""){const n=L.map(t).setView([e,o],13);L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(n);const s=L.marker([e,o]).addTo(n);return r&&s.bindPopup(r).openPopup(),n}function Ko(t,e,o){const r=L.map(t).setView([e,o],13),n={OpenStreetMap:L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}),Satellite:L.tileLayer("https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",{attribution:"Tiles &copy; Esri &mdash; Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community"})};return n.OpenStreetMap.addTo(r),L.control.layers(n).addTo(r),r}const lt=(t,e)=>e.some(o=>t instanceof o);let Ut,zt;function ei(){return Ut||(Ut=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function ti(){return zt||(zt=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const ct=new WeakMap,ot=new WeakMap,Ye=new WeakMap;function oi(t){const e=new Promise((o,r)=>{const n=()=>{t.removeEventListener("success",s),t.removeEventListener("error",i)},s=()=>{o(re(t.result)),n()},i=()=>{r(t.error),n()};t.addEventListener("success",s),t.addEventListener("error",i)});return Ye.set(e,t),e}function ri(t){if(ct.has(t))return;const e=new Promise((o,r)=>{const n=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",i),t.removeEventListener("abort",i)},s=()=>{o(),n()},i=()=>{r(t.error||new DOMException("AbortError","AbortError")),n()};t.addEventListener("complete",s),t.addEventListener("error",i),t.addEventListener("abort",i)});ct.set(t,e)}let dt={get(t,e,o){if(t instanceof IDBTransaction){if(e==="done")return ct.get(t);if(e==="store")return o.objectStoreNames[1]?void 0:o.objectStore(o.objectStoreNames[0])}return re(t[e])},set(t,e,o){return t[e]=o,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function Xo(t){dt=t(dt)}function ni(t){return ti().includes(t)?function(...e){return t.apply(ut(this),e),re(this.request)}:function(...e){return re(t.apply(ut(this),e))}}function si(t){return typeof t=="function"?ni(t):(t instanceof IDBTransaction&&ri(t),lt(t,ei())?new Proxy(t,dt):t)}function re(t){if(t instanceof IDBRequest)return oi(t);if(ot.has(t))return ot.get(t);const e=si(t);return e!==t&&(ot.set(t,e),Ye.set(e,t)),e}const ut=t=>Ye.get(t);function ii(t,e,{blocked:o,upgrade:r,blocking:n,terminated:s}={}){const i=indexedDB.open(t,e),l=re(i);return r&&i.addEventListener("upgradeneeded",c=>{r(re(i.result),c.oldVersion,c.newVersion,re(i.transaction),c)}),o&&i.addEventListener("blocked",c=>o(c.oldVersion,c.newVersion,c)),l.then(c=>{s&&c.addEventListener("close",()=>s()),n&&c.addEventListener("versionchange",d=>n(d.oldVersion,d.newVersion,d))}).catch(()=>{}),l}const ai=["get","getKey","getAll","getAllKeys","count"],li=["put","add","delete","clear"],rt=new Map;function Wt(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(rt.get(e))return rt.get(e);const o=e.replace(/FromIndex$/,""),r=e!==o,n=li.includes(o);if(!(o in(r?IDBIndex:IDBObjectStore).prototype)||!(n||ai.includes(o)))return;const s=async function(i,...l){const c=this.transaction(i,n?"readwrite":"readonly");let d=c.store;return r&&(d=d.index(l.shift())),(await Promise.all([d[o](...l),n&&c.done]))[0]};return rt.set(e,s),s}Xo(t=>({...t,get:(e,o,r)=>Wt(e,o)||t.get(e,o,r),has:(e,o)=>!!Wt(e,o)||t.has(e,o)}));const ci=["continue","continuePrimaryKey","advance"],Vt={},ht=new WeakMap,Jo=new WeakMap,di={get(t,e){if(!ci.includes(e))return t[e];let o=Vt[e];return o||(o=Vt[e]=function(...r){ht.set(this,Jo.get(this)[e](...r))}),o}};async function*ui(...t){let e=this;if(e instanceof IDBCursor||(e=await e.openCursor(...t)),!e)return;e=e;const o=new Proxy(e,di);for(Jo.set(o,e),Ye.set(o,ut(e));e;)yield o,e=await(ht.get(o)||e.continue()),ht.delete(o)}function Yt(t,e){return e===Symbol.asyncIterator&&lt(t,[IDBIndex,IDBObjectStore,IDBCursor])||e==="iterate"&&lt(t,[IDBIndex,IDBObjectStore])}Xo(t=>({...t,get(e,o,r){return Yt(e,o)?ui:t.get(e,o,r)},has(e,o){return Yt(e,o)||t.has(e,o)}}));const hi="StoryAppDB",mi=4,W="stories",ee="bookmarks",ae="offlineQueue",te="locationCache";let xe=null;const B=async()=>xe||(xe=await ii(hi,mi,{upgrade(t,e,o){if(e<1&&(t.objectStoreNames.contains(W)||t.createObjectStore(W,{keyPath:"id"})),e<2&&(t.objectStoreNames.contains(ee)||t.createObjectStore(ee,{keyPath:"id"})),e<3&&!t.objectStoreNames.contains(ae)){const r=t.createObjectStore(ae,{keyPath:"id",autoIncrement:!0});r.createIndex("timestamp","timestamp"),r.createIndex("status","status")}e<4&&(t.objectStoreNames.contains(te)||t.createObjectStore(te,{keyPath:"coordinates"}))}}),xe);class M{static async getAllStories(){try{return(await B()).getAll(W)}catch(e){return console.error("Error getting all stories:",e),[]}}static async getStory(e){try{return(await B()).get(W,e)}catch(o){return console.error("Error getting story:",o),null}}static async putStory(e){try{return(await B()).put(W,e)}catch(o){return console.error("Error putting story:",o),!1}}static async deleteStory(e){try{return(await B()).delete(W,e)}catch(o){return console.error("Error deleting story:",o),!1}}static async clearStories(){try{return(await B()).clear(W)}catch(e){return console.error("Error clearing stories:",e),!1}}static async syncWithAPI(e){try{const r=(await B()).transaction(W,"readwrite"),n=r.objectStore(W),s=await n.getAll(),i=s.filter(l=>l.id.toString().startsWith("offline-")||l.pending===!0);for(const l of s)!l.id.toString().startsWith("offline-")&&!l.pending&&await n.delete(l.id);for(const l of e){const c=i.find(d=>d.description===l.description&&new Date(d.createdAt).getTime()-new Date(l.createdAt).getTime()<6e4);c&&(await n.delete(c.id),await this._updateBookmarkReference(c.id,l.id),console.log(`Replaced pending story (${c.id}) with synced story (${l.id})`)),await n.put(l)}return await r.done,!0}catch(o){return console.error("Error syncing with API:",o),!1}}static async _updateBookmarkReference(e,o){try{const n=(await B()).transaction(ee,"readwrite");if(await n.store.get(e)){const i=await this.getStory(o);i&&(await n.store.delete(e),await n.store.put({...i,id:o}),console.log(`Updated bookmark reference from ${e} to ${o}`))}await n.done}catch(r){console.error("Error updating bookmark reference:",r)}}static async getAllBookmarks(){try{return(await B()).getAll(ee)}catch(e){return console.error("Error getting all bookmarks:",e),[]}}static async getBookmark(e){try{return(await B()).get(ee,e)}catch(o){return console.error("Error getting bookmark:",o),null}}static async addBookmark(e){try{return(await B()).put(ee,e)}catch(o){return console.error("Error adding bookmark:",o),!1}}static async removeBookmark(e){try{return(await B()).delete(ee,e)}catch(o){return console.error("Error removing bookmark:",o),!1}}static async isBookmarked(e){try{return!!await this.getBookmark(e)}catch(o){return console.error("Error checking bookmark:",o),!1}}static async saveForSync(e){try{const o={url:e.url,method:e.method,body:e.body,timestamp:new Date().getTime(),status:"pending"};return(await B()).add(ae,o)}catch(o){return console.error("Error saving for sync:",o),!1}}static async getPendingOperations(){try{return(await B()).transaction(ae,"readonly").store.index("status").getAll("pending")}catch(e){return console.error("Error getting pending operations:",e),[]}}static async markOperationComplete(e){try{const r=(await B()).transaction(ae,"readwrite"),n=await r.store.get(e);return n&&(n.status="completed",await r.store.put(n)),r.done}catch(o){return console.error("Error marking operation complete:",o),!1}}static async deleteOperation(e){try{return(await B()).delete(ae,e)}catch(o){return console.error("Error deleting operation:",o),!1}}static async getCachedLocation(e,o){try{const r=this._formatCoordinateKey(e,o);return(await B()).get(te,r)}catch(r){return console.error("Error getting cached location:",r),null}}static async cacheLocation(e,o,r,n=30){try{const i={coordinates:this._formatCoordinateKey(e,o),name:r,timestamp:Date.now(),expiryTime:Date.now()+n*24*60*60*1e3};return await(await B()).put(te,i),!0}catch(s){return console.error("Error caching location:",s),!1}}static async getAllCachedLocations(){try{return(await B()).getAll(te)}catch(e){return console.error("Error getting all cached locations:",e),[]}}static async clearExpiredLocationCache(){try{const o=(await B()).transaction(te,"readwrite"),r=o.objectStore(te),n=await r.getAll(),s=Date.now();let i=0;for(const l of n)l.expiryTime&&l.expiryTime<s&&(await r.delete(l.coordinates),i++);return await o.done,i>0&&console.log(`Cleared ${i} expired location cache entries`),i}catch(e){return console.error("Error clearing expired location cache:",e),0}}static _formatCoordinateKey(e,o){if(typeof e!="number"||typeof o!="number")throw new Error("Latitude and longitude must be numbers");return`${e.toFixed(6)},${o.toFixed(6)}`}}class fi{constructor(){this._isOnline=navigator.onLine,this._listeners=[],window.addEventListener("online",()=>this._handleOnline()),window.addEventListener("offline",()=>this._handleOffline())}get isOnline(){return navigator.onLine}addListener(e){return typeof e!="function"?()=>{}:(this._listeners.push(e),()=>{this._listeners=this._listeners.filter(o=>o!==e)})}_handleOnline(){this._isOnline||(this._isOnline=!0,u("You are back online","success"),this._triggerBackgroundSync(),this._notifyListeners())}_handleOffline(){this._isOnline&&(this._isOnline=!1,u("You are offline. You can still browse cached content and your changes will sync when you're back online.","warning"),this._notifyListeners())}_notifyListeners(){this._listeners.forEach(e=>{try{e(this._isOnline)}catch(o){console.error("Error in network status listener:",o)}})}async _triggerBackgroundSync(){if("serviceWorker"in navigator)try{const e=await navigator.serviceWorker.ready;"sync"in e&&await e.sync.register("story-queue")}catch(e){console.error("Error triggering background sync:",e)}}}const X=new fi;class E{static handleApiError(e,{context:o="API",defaultMessage:r="An error occurred. Please try again later.",showNotification:n=!0}={}){console.error(`[${o}] Error:`,e);let s=r;return e.message.includes("Failed to fetch")||e.message.includes("NetworkError")?s="Network error. Please check your connection and try again.":e.message.includes("401")||e.message.includes("Unauthorized")?s="Your session has expired. Please login again.":e.message.includes("403")||e.message.includes("Forbidden")?s="You don't have permission to perform this action.":e.message.includes("404")||e.message.includes("Not found")?s="The requested resource was not found.":(e.message.includes("timeout")||e.message.includes("timed out"))&&(s="Request timed out. Please try again."),n&&u(s,"error"),e}static handleFormError(e,{form:o=null,submitButton:r=null,context:n="Form submission",defaultMessage:s="There was a problem submitting the form. Please try again."}={}){return this.handleApiError(e,{context:n,defaultMessage:s}),r&&(r.disabled=!1,r.classList.contains("loading")&&(r.classList.remove("loading"),r.innerHTML=r.getAttribute("data-original-text")||"Submit")),e}static handleOfflineError(e,{offlineAction:o=null,onlineAction:r=null}={}){return!navigator.onLine||e.message.includes("Failed to fetch")||e.message.includes("NetworkError")?(u("You are offline. Some features may not be available.","warning"),typeof o=="function"&&o(e)):(this.handleApiError(e),typeof r=="function"&&r(e)),e}}class ye{static async _fetchWithAuth(e,o={}){const r=localStorage.getItem("token");if(!r)throw new Error("No authentication token found");const n={...o.headers,Authorization:`Bearer ${r}`},s=await fetch(`${T.BASE_URL}${e}`,{...o,headers:n});if(!s.ok)throw new Error(`HTTP error! status: ${s.status}`);return s.json()}static async _fetchWithoutAuth(e,o={}){const r=await fetch(`${T.BASE_URL}${e}`,o);if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);return r.json()}static async getAllStories(e=!1){try{const o=localStorage.getItem("token");if(!o)throw new Error("No authentication token found");const r=e?"?location=1":"",n=`${T.BASE_URL}/stories${r}`;if(!X.isOnline){const l=await M.getAllStories();if(l.length>0)return u("You are offline. Showing cached stories.","info"),l;throw new Error("You are offline and no cached stories are available")}const s=await fetch(n,{headers:{Authorization:`Bearer ${o}`}});if(!s.ok)throw new Error(`HTTP error! status: ${s.status}`);const i=await s.json();if(!i.error&&i.listStory)return await M.syncWithAPI(i.listStory),i.listStory;throw new Error(i.message||"Failed to fetch stories")}catch(o){return E.handleOfflineError(o,{offlineAction:async()=>{const r=await M.getAllStories();if(r.length>0)return r;throw o}})}}static async getStoryDetail(e){try{const o=localStorage.getItem("token"),r=`${T.BASE_URL}/stories/${e}`,n=await fetch(r,{headers:{Authorization:`Bearer ${o}`}});if(!n.ok)throw new Error(`HTTP error! status: ${n.status}`);const s=await n.json();if(!s.error&&s.story)return s;throw new Error(s.message||"Failed to fetch story detail")}catch(o){if(console.error("Failed to fetch story detail:",o),!navigator.onLine||o.message.includes("Failed to fetch")){const r=await M.getStory(e);if(r)return u("Showing cached story content","info"),{story:r}}throw u("Failed to load story detail. Please try again.","error"),o}}static async addStory({description:e,photo:o,lat:r,lon:n}){try{const s=new FormData;s.append("description",e),s.append("photo",o),r&&s.append("lat",r),n&&s.append("lon",n);const i=localStorage.getItem("token"),l=`${T.BASE_URL}/stories`;if(!navigator.onLine){const m=await this._convertBlobToBase64(o);await M.saveForSync({type:"add-story",url:l,method:"POST",body:{description:e,photo:m,lat:r||null,lon:n||null,token:i}});const p={id:`offline-${Date.now()}`,description:e,photoUrl:URL.createObjectURL(o),createdAt:new Date().toISOString(),lat:r||null,lon:n||null,name:localStorage.getItem("name")||"User",pending:!0};return await M.putStory(p),u("Story saved offline and will be uploaded when you are back online","info"),{error:!1,message:"Story saved for sync",story:p}}const c=await fetch(l,{method:"POST",headers:{Authorization:`Bearer ${i}`},body:s});if(!c.ok)throw new Error(`HTTP error! status: ${c.status}`);const d=await c.json();if(d.error)throw new Error(d.message||"Failed to add story");return u("Story added successfully!"),d}catch(s){throw console.error("Failed to add story:",s),u("Failed to add story. Please try again.","error"),s}}static async _convertBlobToBase64(e){return new Promise((o,r)=>{const n=new FileReader;n.onloadend=()=>o(n.result),n.onerror=r,n.readAsDataURL(e)})}static async register({name:e,email:o,password:r}){try{const n=await fetch(`${T.BASE_URL}/register`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e,email:o,password:r})});if(!n.ok)throw new Error(`HTTP error! status: ${n.status}`);const s=await n.json();if(s.error)throw new Error(s.message||"Registration failed");return u("Registration successful! Please login."),s}catch(n){throw console.error("Registration failed:",n),u("Registration failed. Please try again.","error"),n}}static async login({email:e,password:o}){try{const r=await fetch(`${T.BASE_URL}/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:o})});if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);const n=await r.json();if(!n.error&&n.loginResult)return localStorage.setItem("token",n.loginResult.token),localStorage.setItem("name",n.loginResult.name),document.dispatchEvent(new Event("authChanged")),u("Login successful!"),n;throw new Error(n.message||"Login failed")}catch(r){throw console.error("Login failed:",r),u("Login failed. Please check your credentials.","error"),r}}static async addGuestStory({description:e,photo:o,lat:r,lon:n}){try{const s=new FormData;s.append("description",e),s.append("photo",o),r&&s.append("lat",r),n&&s.append("lon",n);const i=`${T.BASE_URL}/stories/guest`;if(!navigator.onLine){const d=await this._convertBlobToBase64(o);await M.saveForSync({type:"add-guest-story",url:i,method:"POST",body:{description:e,photo:d,lat:r||null,lon:n||null}});const m={id:`offline-guest-${Date.now()}`,description:e,photoUrl:URL.createObjectURL(o),createdAt:new Date().toISOString(),lat:r||null,lon:n||null,name:"Guest (pending)",pending:!0};return await M.putStory(m),u("Guest story saved offline and will be uploaded when you are back online","info"),{error:!1,message:"Story saved for sync",story:m}}const l=await fetch(i,{method:"POST",body:s});if(!l.ok)throw new Error(`HTTP error! status: ${l.status}`);const c=await l.json();if(c.error)throw new Error(c.message||"Failed to add guest story");return c}catch(s){throw console.error("Failed to add guest story:",s),u("Failed to add story. Please try again.","error"),s}}static async getGuestStories(){try{const e=`${T.BASE_URL}/stories/guest`,o=await fetch(e);if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);const r=await o.json();if(!r.error&&r.listStory)return r.listStory.map(s=>({...s,name:"Guest"}));throw new Error(r.message||"Failed to fetch guest stories")}catch(e){if(console.error("Failed to fetch guest stories:",e),!navigator.onLine||e.message.includes("Failed to fetch")){const r=(await M.getAllStories()).filter(n=>n.name==="Guest"||n.name==="Guest (pending)");if(r.length>0)return u("Showing cached guest stories","info"),r}return u("Failed to load guest stories. Please try again.","error"),[]}}}class wi{constructor(e){this._view=e,this._storyApi=ye,this._storyIDB=M,this._networkStatusListener=X.addListener(o=>{o&&setTimeout(()=>{this.fetchStories()},500)}),this._setupSyncListener()}_setupSyncListener(){navigator.serviceWorker.addEventListener("message",e=>{e.data&&e.data.type==="STORY_SYNCED"&&(u("Your story has been uploaded successfully!","success"),setTimeout(()=>{this.fetchStories()},1e3))})}async fetchStories(){try{if(!localStorage.getItem("token")){if(!this._view||!this._isViewMounted()){console.warn("View is not mounted, skipping fetchStories");return}this._view.showLoginRequired();return}const o=await this._storyIDB.getAllStories();if(!this._view||!this._isViewMounted()){console.warn("View is not mounted, skipping cached stories display");return}if(o&&o.length>0&&this._view.displayStories(o),X.isOnline)try{const r=await this._storyApi.getAllStories();if(!this._view||!this._isViewMounted()){console.warn("View is not mounted, skipping online stories display");return}r&&r.length>0?this._view.displayStories(r):(!o||o.length===0)&&this._view.showNoStories()}catch(r){if(!this._view||!this._isViewMounted()){console.warn("View is not mounted, skipping error handling");return}if(E.handleApiError(r,{context:"Fetching stories",defaultMessage:"Failed to load stories. Showing cached content."}),!o||o.length===0){const n=await this._storyIDB.getAllStories();if(!this._view||!this._isViewMounted())return;if(n.length>0)this._view.displayStories(n);else throw r}}else{if(!this._view||!this._isViewMounted())return;o&&o.length>0?u("You are offline. Showing cached stories.","info"):this._view.showError("You are offline and no cached stories are available.")}}catch(e){if(!this._view||!this._isViewMounted())return;E.handleApiError(e,{context:"Story loading",defaultMessage:"Failed to load stories. Please try again later."}),this._view.showError(e.message||"Failed to load stories. Please try again later.")}}async fetchStoriesWithLocation(){try{if(X.isOnline)try{return await this._storyApi.getAllStories(!0)}catch(e){throw E.handleApiError(e,{context:"Fetching map locations",showNotification:!1}),e}else{const o=(await this._storyIDB.getAllStories()).filter(r=>r.lat&&r.lon);if(o.length>0)return u("Showing cached story locations","info"),o;throw new Error("No cached story locations available")}}catch(e){return this._view&&this._isViewMounted()&&E.handleOfflineError(e,{offlineAction:()=>this._view.showMapError("You are offline. No cached map data available.")}),[]}}_isViewMounted(){return this._view._storyListElement?document.body.contains(this._view._storyListElement):!1}cleanup(){this._networkStatusListener&&this._networkStatusListener()}}class q{static animateElement(e,o={}){if(!e)return;const{delay:r=0,duration:n="0.5s",easing:s="ease",opacity:i="1",transform:l="none",callback:c=null}=o;setTimeout(()=>{e.style.transition=`opacity ${n} ${s}, transform ${n} ${s}`,e.style.opacity=i,e.style.transform=l,c&&e.addEventListener("transitionend",()=>{c(e)},{once:!0})},r)}static animateFormElements(e,o=100,r=150){!e||!e.length||Array.from(e).forEach((n,s)=>{this.animateElement(n,{delay:o+s*r,transform:"translateY(0)"})})}static animateStoryDetail(e){const{header:o,imageContainer:r,description:n,map:s}=e;o&&this.animateElement(o,{delay:100,transform:"translateY(0)"}),r&&this.animateElement(r,{delay:200,transform:"scale(1)"}),n&&this.animateElement(n,{delay:300,transform:"translateX(0)"}),s&&this.animateElement(s,{delay:400,duration:"0.8s"})}static animateStoryCard(e,o=100){e&&this.animateElement(e,{delay:o,transform:"translateY(0)"})}}class pi{constructor(e){this._view=e,this._storyIDB=M,this._cleanupExpiredLocationCache()}async isStoryBookmarked(e){try{return await this._storyIDB.isBookmarked(e)}catch(o){return console.error("Error checking bookmark status:",o),!1}}async addBookmark(e){try{return await this._storyIDB.addBookmark(e),!0}catch(o){return E.handleApiError(o,{context:"Adding bookmark",defaultMessage:"Failed to add bookmark"}),!1}}async removeBookmark(e){try{return await this._storyIDB.removeBookmark(e),!0}catch(o){return E.handleApiError(o,{context:"Removing bookmark",defaultMessage:"Failed to remove bookmark"}),!1}}async getLocationName(e,o){try{const r=this._formatCoordinates(e,o);this._view.updateLocationName(r);const n=await this._storyIDB.getCachedLocation(e,o);if(n&&n.expiryTime&&n.expiryTime>Date.now())return this._view.updateLocationName(n.name),n.name;if(!X.isOnline)return r;try{const s=await Promise.race([this._fetchLocationName(e,o),new Promise((i,l)=>{setTimeout(()=>{l(new Error("Location fetch timeout"))},8e3)})]);return await this._storyIDB.cacheLocation(e,o,s),this._view.updateLocationName(s),s}catch(s){return console.warn("Location fetch failed:",s.message),await this._storyIDB.cacheLocation(e,o,r,7),r}}catch(r){return console.error("Error getting location name:",r),this._formatCoordinates(e,o)}}async _cleanupExpiredLocationCache(){try{setTimeout(async()=>{const e=await this._storyIDB.clearExpiredLocationCache();e>0&&console.log(`Cleared ${e} expired location entries from cache`)},1e3)}catch(e){console.error("Error cleaning up location cache:",e)}}async _fetchLocationName(e,o){try{if(!navigator.onLine)throw new Error("Device is offline");return await Promise.any([this._fetchFromNominatim(e,o),this._fetchFromBackupSource(e,o)])}catch(r){return console.warn("All geocoding sources failed:",r),this._formatCoordinates(e,o)}}async _fetchFromNominatim(e,o){try{await new Promise(s=>setTimeout(s,100));const r=await fetch(`https://nominatim.openstreetmap.org/reverse?lat=${e}&lon=${o}&format=json&zoom=16`,{headers:{"Accept-Language":"en-US,en;q=0.9,id;q=0.8","User-Agent":"StoryApp/1.0 (educational project)"},cache:"force-cache"});if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);const n=await r.json();if(n.address){const s=[];return n.address.suburb?s.push(n.address.suburb):n.address.neighbourhood?s.push(n.address.neighbourhood):n.address.village&&s.push(n.address.village),n.address.city?s.push(n.address.city):n.address.town?s.push(n.address.town):n.address.county&&s.push(n.address.county),s.length===0?n.display_name.split(",").slice(0,2).join(", "):s.join(", ")}else throw new Error("No address data returned")}catch(r){throw console.warn("Nominatim geocoding failed:",r.message),r}}async _fetchFromBackupSource(e,o){throw await new Promise(r=>setTimeout(r,1e3)),new Error("Backup source not implemented")}_formatCoordinates(e,o){return`${e.toFixed(4)}, ${o.toFixed(4)}`}}class gi extends HTMLElement{constructor(){super(),this._story=null,this._locationName="Unknown location",this._isBookmarked=!1,this._presenter=new pi(this)}set story(e){this._story=e,this._checkBookmarkStatus()}async _checkBookmarkStatus(){this._story&&(this._isBookmarked=await this._presenter.isStoryBookmarked(this._story.id),this.render(),this._fetchLocationName())}render(){if(!this._story)return;const e=this._story.name==="Guest",o=this._isBookmarked?"fas fa-bookmark":"far fa-bookmark";this.dataset.storyId=this._story.id,this.innerHTML=`
        <article class="story-item" data-id="${this._story.id}" style="opacity: 0; transform: translateY(20px);">
        <img 
            src="${this._story.photoUrl}" 
            alt="Story by ${this._story.name}" 
            loading="lazy"
            class="story-item__bg-image"
        >
        <div class="story-item__header">
            <h3 class="story-item__title">
            ${e?'<i class="fas fa-user-secret guest-icon"></i>':""} ${this._story.name}
            </h3>
            <button class="bookmark-btn" data-id="${this._story.id}" aria-label="${this._isBookmarked?"Remove from bookmarks":"Add to bookmarks"}">
              <i class="${o}"></i>
            </button>
            <p class="story-item__location">
            ${this._story.lat&&this._story.lon?'<i class="fas fa-map-marker-alt"></i> <span class="location-name">Loading location...</span>':""}
            </p>
        </div>
        <div class="story-item__footer">
            <div class="story-item__description-container">
              <p class="story-item__description">
              ${this._story.description.length>50?`${this._story.description.substring(0,50)}...`:this._story.description}
              </p>
            </div>
            <p class="story-item__date">${Go(this._story.createdAt)}</p>
            <a href="#/stories/${this._story.id}" class="story-item__detail-btn">
              <i class="fas fa-eye"></i>Details
            </a>
        </div>
        </article>
    `;const r=this.querySelector(".story-item");r&&q.animateStoryCard(r),this._initBookmarkButton()}_initBookmarkButton(){const e=this.querySelector(".bookmark-btn");e&&e.addEventListener("click",async o=>{o.stopPropagation();try{this._isBookmarked?(await this._presenter.removeBookmark(this._story.id),this._isBookmarked=!1,u("Story removed from bookmarks","success"),this.dispatchEvent(new CustomEvent("bookmark:removed",{bubbles:!0,detail:{storyId:this._story.id}}))):(await this._presenter.addBookmark(this._story),this._isBookmarked=!0,u("Story added to bookmarks","success"));const r=e.querySelector("i");r.className=this._isBookmarked?"fas fa-bookmark":"far fa-bookmark",e.setAttribute("aria-label",this._isBookmarked?"Remove from bookmarks":"Add to bookmarks")}catch(r){console.error("Error toggling bookmark:",r),u("Failed to update bookmark","error")}})}async _fetchLocationName(){if(!(!this._story||!this._story.lat||!this._story.lon))try{const e=await this._presenter.getLocationName(this._story.lat,this._story.lon),o=this.querySelector(".location-name");o&&(o.textContent=e)}catch(e){console.error("Error fetching location name:",e);const o=this.querySelector(".location-name");o&&(o.textContent=`${this._story.lat.toFixed(4)}, ${this._story.lon.toFixed(4)}`)}}updateBookmarkStatus(e){this._isBookmarked=e;const o=this.querySelector(".bookmark-btn");if(o){const r=o.querySelector("i");r.className=this._isBookmarked?"fas fa-bookmark":"far fa-bookmark",o.setAttribute("aria-label",this._isBookmarked?"Remove from bookmarks":"Add to bookmarks")}}updateLocationName(e){const o=this.querySelector(".location-name");o&&(o.textContent=e)}}customElements.define("story-card",gi);class yi extends HTMLElement{set stories(e){this._stories=e,this.render()}render(){if(!this._stories||this._stories.length===0){this.innerHTML=`
        <div class="no-stories">
          <p>No stories available yet.</p>
        </div>
      `;return}this.innerHTML="",this._stories.forEach(e=>{const o=document.createElement("story-card");o.story=e,this.appendChild(o)})}renderError(e){this.innerHTML=`
      <div class="error-message">
        <p>${e}</p>
      </div>
    `}}customElements.define("story-list",yi);class Gt{constructor(){this._stories=[],this._map=null,this._storyListElement=null,this._presenter=new wi(this)}async render(){return`
      <section class="hero">
        <div class="hero__inner">
          <h1 class="hero__title">Share Your Story</h1>
          <p class="hero__tagline">Tell your amazing experiences and inspire others</p>
          <a href="#/add-story" class="hero__button">Add Your Story</a>
        </div>
      </section>
      
      <div class="container">
        <section class="content-section map-section">
          <h2 class="section-title">Story Locations</h2>
          <div id="map" style="height: 400px;"></div>
        </section>
        
        <section class="content-section stories-section">
          <h2 class="section-title">Recent Stories</h2>
          <div id="story-list-container">
            <story-list class="story-list">
              ${tt()}
            </story-list>
          </div>
        </section>
      </div>
    `}async afterRender(){const e=document.querySelector("story-list");this._storyListElement=e;try{await this._presenter.fetchStories(),this._initializeMap()}catch(o){E.handleApiError(o,{context:"Home page initialization",defaultMessage:"Failed to initialize home page"})}window.addEventListener("hashchange",this._cleanup.bind(this))}_cleanup(){this._presenter&&this._presenter.cleanup(),this._map&&(this._map.remove(),this._map=null),window.removeEventListener("hashchange",this._cleanup.bind(this))}displayStories(e){if(this._stories=e,!this._storyListElement||!document.body.contains(this._storyListElement)){const o=document.getElementById("story-list-container");if(o)o.innerHTML="",this._storyListElement=document.createElement("story-list"),this._storyListElement.className="story-list",o.appendChild(this._storyListElement);else{console.warn("Story list container not found");return}}this._storyListElement.stories=this._stories,setTimeout(()=>{document.querySelectorAll(".story-item").forEach((r,n)=>{q.animateElement(r,{delay:100+n*50,transform:"translateY(0)",opacity:"1"})})},100)}showNoStories(){if(!this._storyListElement||!document.body.contains(this._storyListElement)){const e=document.getElementById("story-list-container");e&&(e.innerHTML=`
          <div class="no-stories">
            <p>No stories available. Be the first to share!</p>
          </div>
        `);return}this._storyListElement.innerHTML=`
      <div class="no-stories">
        <p>No stories available. Be the first to share!</p>
      </div>
    `}showLoginRequired(){if(!this._storyListElement||!document.body.contains(this._storyListElement)){const e=document.getElementById("story-list-container");e&&(e.innerHTML=`
          <div class="error-message">
            <p>You need to login first to view stories.</p>
            <a href="#/login" class="login-link">Click here to login</a>
          </div>
        `);return}this._storyListElement.innerHTML=`
      <div class="error-message">
        <p>You need to login first to view stories.</p>
        <a href="#/login" class="login-link">Click here to login</a>
      </div>
    `}showError(e){if(!this._storyListElement||!document.body.contains(this._storyListElement)){const r=document.getElementById("story-list-container");if(r){r.innerHTML=`
          <div class="error-message">
            <p>${e}</p>
            <button class="retry-button" id="retry-button">Retry</button>
          </div>
        `;const n=document.getElementById("retry-button");n&&n.addEventListener("click",()=>{r.innerHTML=tt(),this._presenter.fetchStories()})}return}this._storyListElement.innerHTML=`
      <div class="error-message">
        <p>${e}</p>
        <button class="retry-button" id="retry-button">Retry</button>
      </div>
    `;const o=document.getElementById("retry-button");o&&o.addEventListener("click",()=>{this._storyListElement.innerHTML=tt(),this._presenter.fetchStories()})}showMapError(e){const o=document.getElementById("map");o&&(o.innerHTML=`
        <div class="map-error">
          <p>${e}</p>
        </div>
      `,o.classList.add("map-error-container"))}async _initializeMap(){try{if(!document.getElementById("map")){console.warn("Map element not found");return}this._map=Ko("map",-6.2088,106.8456);const n=await this._presenter.fetchStoriesWithLocation();this._displayStoriesOnMap(n),setTimeout(()=>{this._map&&this._map.invalidateSize()},100)}catch(e){E.handleApiError(e,{context:"Map initialization",defaultMessage:"Failed to load the map",showNotification:!1}),this.showMapError("Failed to load the map. Please try again later.")}}_displayStoriesOnMap(e){if(!this._map)return;const o=[];if(e.forEach(r=>{if(r.lat&&r.lon){const n=L.marker([r.lat,r.lon]).addTo(this._map),s=`
          <div class="story-popup">
            <h3>${r.name}</h3>
            <img src="${r.photoUrl}" alt="story by ${r.name}" style="max-width:100px; max-height:100px; margin:5px 0;">
            <p>${r.description.substring(0,100)}${r.description.length>100?"...":""}</p>
            <p class="story-date">Posted on: ${new Date(r.createdAt).toLocaleDateString()}</p>
            <a href="#/stories/${r.id}" class="story-link">View full story</a>
          </div>
        `;n.bindPopup(s),o.push(n)}}),o.length>0&&this._map){const r=L.featureGroup(o);this._map.fitBounds(r.getBounds().pad(.1))}}}class bi{async render(){return`
        <section class="hero">
          <div class="hero__inner">
            <h1 class="hero__title">Share Your Story</h1>
            <p class="hero__tagline">Tell your amazing experiences and inspire others</p>
            <div class="hero__cta">
              <a href="#/add-guest-story" class="hero-button">
                <i class="fas fa-plus"></i> Add Your Story
              </a>
            </div>
          </div>
        </section>
        
        <div class="container">
          <section class="content-section stories-section">
            <h2 class="section-title">Recent Stories</h2>
            <div class="guest-message">
                <div class="guest-card">
                  <i class="fas fa-lock"></i>
                  <h3>Login Required</h3>
                  <p>You need to login first to view stories from our web.</p>
                  <div class="guest-buttons">
                    <a href="#/login" class="guest-button primary">Login</a>
                    <a href="#/register" class="guest-button secondary">Register</a>
                  </div>
                </div>
              </div>
          </section>
        </div>
    `}async afterRender(){}}function Zo(t){const e=t.split("/");return{resource:e[1]||null,id:e[2]||null}}function vi(t){let e="";return t.resource&&(e=e.concat(`/${t.resource}`)),t.id&&(e=e.concat("/:id")),e||"/"}function Qo(){return location.hash.replace("#","")||"/"}function Kt(){const t=Qo(),e=Zo(t);return vi(e)}function ki(){const t=Qo();return Zo(t)}class Ei{constructor(e){this._view=e,this._storyApi=ye,this._storyIDB=M}async loadStoryDetail(e){try{if(this._view.animateElements(),!X.isOnline){const r=await this._storyIDB.getStory(e);if(r){const n=await this._storyIDB.isBookmarked(e);this._view.updateStoryDetail(r,n);return}else throw new Error("You are offline and this story is not available in your cache.")}const o=await this._storyApi.getStoryDetail(e);if(o.story){await this._storyIDB.putStory(o.story);const r=await this._storyIDB.isBookmarked(e);this._view.updateStoryDetail(o.story,r)}else throw new Error("Failed to get story details")}catch(o){E.handleOfflineError(o,{offlineAction:async()=>{const r=await this._storyIDB.getStory(e);if(r){const n=await this._storyIDB.isBookmarked(e);this._view.updateStoryDetail(r,n)}else this._view.showErrorState()},onlineAction:()=>{this._view.showErrorState()}})}}async addBookmark(e){try{const o=await this._storyIDB.getStory(e);if(!o)throw new Error("Story not found");return await this._storyIDB.addBookmark(o),!0}catch(o){return E.handleApiError(o,{context:"Adding bookmark",defaultMessage:"Failed to add bookmark"}),!1}}async removeBookmark(e){try{return await this._storyIDB.removeBookmark(e),!0}catch(o){return E.handleApiError(o,{context:"Removing bookmark",defaultMessage:"Failed to remove bookmark"}),!1}}async isBookmarked(e){try{return await this._storyIDB.isBookmarked(e)}catch(o){return console.error("Error checking bookmark status:",o),!1}}}class Si{constructor(){this.presenter=new Ei(this),this._story=null,this._isBookmarked=!1}async render(){return`
        <section class="story-detail">
          <div class="story-detail__container">
            <div class="story-detail__header" style="opacity: 0; transform: translateY(-20px);">
              <div class="story-detail__title-area">
                <h1 class="story-detail__title">Loading Story...</h1>
                <div class="story-detail__meta"></div>
              </div>
              <div class="story-detail__actions">
                <button id="bookmark-button" class="button bookmark-icon-button" aria-label="Bookmark this story">
                  <i class="far fa-bookmark"></i>
                </button>
              </div>
            </div>
            <div class="story-detail__content">
              <div class="story-detail__image-container" style="opacity: 0; transform: scale(0.9);">
                <img class="story-detail__image skeleton" alt="Story image" />
              </div>
              <div class="story-detail__description" style="opacity: 0; transform: translateX(20px);"></div>
            </div>
            <div id="story-map" class="story-detail__map" style="opacity: 0;"></div>
          </div>
        </section>
    `}async afterRender(){const{id:e}=ki();if(!e){window.location.hash="#/";return}try{await this.presenter.loadStoryDetail(e),this._setupBookmarkButton()}catch(o){E.handleApiError(o,{context:"Loading story detail",showNotification:!1})}}_setupBookmarkButton(){const e=document.getElementById("bookmark-button");e&&e.addEventListener("click",async()=>{try{this._isBookmarked?(await this.presenter.removeBookmark(this._story.id),this._isBookmarked=!1,u("Story removed from bookmarks","info")):(await this.presenter.addBookmark(this._story),this._isBookmarked=!0,u("Story added to bookmarks","success")),this._updateBookmarkButton()}catch(o){E.handleApiError(o,{context:"Updating bookmark",defaultMessage:"Failed to update bookmark"})}})}_updateBookmarkButton(){const e=document.getElementById("bookmark-button");if(!e)return;const o=e.querySelector("i");o.className=this._isBookmarked?"fas fa-bookmark":"far fa-bookmark"}updateStoryDetail(e,o){this._story=e,this._isBookmarked=o,this._updateBookmarkButton();const r=e.name==="Guest",n=document.querySelector(".story-detail__title");n.innerHTML=`
      ${r?'<i class="fas fa-user-secret"></i>':'<i class="fas fa-user"></i>'} 
      ${e.name||"Untitled Story"}
    `;const s=document.querySelector(".story-detail__meta");s.innerHTML=`
      <span class="story-detail__author">By ${e.name||"Anonymous"}</span>
      <span class="story-detail__date">${Go(e.createdAt)}</span>
    `;const i=document.querySelector(".story-detail__image");e.photoUrl?(i.src=e.photoUrl,i.alt=`Story by ${e.name||"Anonymous"}`,i.classList.remove("skeleton")):(i.src="/public/images/default-story.jpg",i.alt="Default story image");const l=document.querySelector(".story-detail__description");l.textContent=e.description||"No description provided";const c=document.getElementById("story-map");e.lat&&e.lon?Qs("story-map",e.lat,e.lon,`<b>${e.name||"Story Location"}</b><br>${e.description||""}`):c.innerHTML=`
        <p class="no-location">No location data available for this story</p>
      `}animateElements(){const e=document.querySelector(".story-detail__header"),o=document.querySelector(".story-detail__image-container"),r=document.querySelector(".story-detail__description"),n=document.getElementById("story-map");q.animateStoryDetail({header:e,imageContainer:o,description:r,map:n})}showErrorState(){const e=document.querySelector(".story-detail__container");e.innerHTML=`
      <div class="error-state">
        <h2>Failed to Load Story</h2>
        <p>We couldn't load the story details. Please try again later.</p>
        <a href="#/" class="back-button">Back to Home</a>
      </div>
    `}}class _i{constructor(e){this._view=e,this._storyApi=ye}async handleAddStory({description:e,photo:o,lat:r,lon:n}){try{if(!o){u("Please add a photo","error");return}if(!e.trim()){u("Please add a description","error");return}const s=await this._storyApi.addStory({description:e,photo:o,lat:r,lon:n});if(s.error)throw new Error(s.message||"Failed to add story");return u("Story added successfully!","success"),setTimeout(()=>{window.location.hash="#/"},1500),!0}catch(s){return X.isOnline?E.handleFormError(s,{context:"Adding story",defaultMessage:"Failed to add story. Please try again."}):E.handleOfflineError(s,{offlineAction:()=>(u("Your story has been saved offline and will be uploaded when you are back online","info"),setTimeout(()=>{window.location.hash="#/"},2e3),!0)})}}}class er{constructor(){this._mediaStream=null,this._photoFile=null,this._isCameraActive=!1,this._takePhoto=this._takePhoto.bind(this),this._resetPhoto=this._resetPhoto.bind(this),this._stopCameraStream=this._stopCameraStream.bind(this)}init(e,o,r,n){this.cameraContainer=document.getElementById(e),this.videoElement=document.getElementById(o),this.controlsContainer=document.getElementById(r),this.photoPreviewContainer=document.getElementById(n);const s=this.controlsContainer.querySelector("#take-photo");return s&&s.addEventListener("click",this._takePhoto),window.addEventListener("beforeunload",this._stopCameraStream),window.addEventListener("pagehide",this._stopCameraStream),this}async startCamera(){this._stopCameraStream();try{return this._mediaStream=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment",width:{ideal:1280},height:{ideal:720}},audio:!1}),this.videoElement.srcObject=this._mediaStream,this._isCameraActive=!0,this.videoElement.style.display="block",this.photoPreviewContainer.style.display="none",!0}catch(e){return console.error("Camera error:",e),this._isCameraActive=!1,!1}}_takePhoto(){if(!this._isCameraActive)return null;const e=document.createElement("canvas");return e.width=this.videoElement.videoWidth,e.height=this.videoElement.videoHeight,e.getContext("2d").drawImage(this.videoElement,0,0,e.width,e.height),e.toBlob(r=>{this._photoFile=new File([r],"photo.jpg",{type:"image/jpeg"}),this.photoPreviewContainer.innerHTML=`
          <div class="preview-container">
            <img src="${URL.createObjectURL(r)}" alt="Captured photo" class="preview-image">
            <button type="button" id="reset-photo" class="reset-photo-button-text">
              <i class="fas fa-times"></i> Remove Photo
            </button>
          </div>
        `,document.getElementById("reset-photo").addEventListener("click",this._resetPhoto),this.photoPreviewContainer.style.display="block"},"image/jpeg",.9),this._photoFile}handleFileUpload(e){this._photoFile=e;const o=new FileReader;return o.onload=r=>{this.photoPreviewContainer.innerHTML=`
          <div class="preview-container">
            <img src="${r.target.result}" alt="Uploaded photo" class="preview-image">
            <button type="button" id="reset-photo" class="reset-photo-button-text">
              <i class="fas fa-times"></i> Remove Photo
            </button>
          </div>
        `,document.getElementById("reset-photo").addEventListener("click",this._resetPhoto),this.photoPreviewContainer.style.display="block"},o.readAsDataURL(e),this._photoFile}_resetPhoto(){return this._photoFile=null,this.photoPreviewContainer.innerHTML="",this.photoPreviewContainer.style.display="none",this.videoElement&&(this.videoElement.style.display="block"),null}_stopCameraStream(){this._mediaStream&&(this._mediaStream.getTracks().forEach(e=>e.stop()),this.videoElement&&(this.videoElement.srcObject=null),this._mediaStream=null,this._isCameraActive=!1)}cleanup(){window.removeEventListener("beforeunload",this._stopCameraStream),window.removeEventListener("pagehide",this._stopCameraStream),this._stopCameraStream()}get photoFile(){return this._photoFile}}class tr{constructor(){this._map=null,this._marker=null,this._userLocation=null,this._getCurrentPosition=this._getCurrentPosition.bind(this),this._getUserLocation=this._getUserLocation.bind(this),this._updateSelectedLocation=this._updateSelectedLocation.bind(this)}init(e,o,r){this.mapElementId=e,this.latitudeElement=document.getElementById(o),this.longitudeElement=document.getElementById(r),this._initMap();const n=document.getElementById("get-user-location");return n&&n.addEventListener("click",this._getUserLocation),this}_initMap(){this._map=Ko(this.mapElementId,-6.1754,106.8272),this._map.on("click",e=>{this._updateSelectedLocation(e.latlng.lat,e.latlng.lng)})}_updateSelectedLocation(e,o){this._userLocation={lat:e,lng:o},this.latitudeElement&&this.longitudeElement&&(this.latitudeElement.textContent=e.toFixed(6),this.longitudeElement.textContent=o.toFixed(6)),this._marker&&this._map.removeLayer(this._marker),this._marker=L.marker([e,o]).addTo(this._map).bindPopup("Your story location").openPopup()}async _getUserLocation(){try{const e=await this._getCurrentPosition(),{latitude:o,longitude:r}=e.coords;this._map.setView([o,r],15),this._updateSelectedLocation(o,r),u("Your location has been set!")}catch(e){console.error("Error getting location:",e),u(`Could not get your location: ${e.message}`,"error")}}_getCurrentPosition(){return new Promise((e,o)=>{if(!navigator.geolocation){o(new Error("Geolocation is not supported by your browser"));return}navigator.geolocation.getCurrentPosition(e,r=>{let n="Error getting your location";switch(r.code){case r.PERMISSION_DENIED:n="Location access was denied";break;case r.POSITION_UNAVAILABLE:n="Location information is unavailable";break;case r.TIMEOUT:n="Location request timed out";break}o(new Error(n))},{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})})}invalidateSize(){this._map&&this._map.invalidateSize()}get userLocation(){return this._userLocation}}class Li{constructor(){Xe(this,"_cleanup",()=>{this.cameraHelper.cleanup(),window.removeEventListener("hashchange",this._cleanup)});this.cameraHelper=new er,this.mapLocationHelper=new tr,this.presenter=new _i(this)}async render(){return`
        <div class="container">
          <section class="add-story">
            <form id="story-form" class="story-form">
              <h1 class="add-story__title" style="opacity: 0; transform: translateY(-20px);">Share Your Story</h1>
              <div class="form-group" style="opacity: 0; transform: translateY(20px);">
                <label for="description">Description</label>
                <textarea 
                  id="description" 
                  name="description" 
                  class="form-control" 
                  rows="5" 
                  required
                  aria-required="true"
                  placeholder="Share your story..."
                ></textarea>
              </div>
              
              <div class="form-group" style="opacity: 0; transform: translateY(20px);">
                <label>Photo</label>
                <div class="photo-options">
                  <button type="button" id="open-camera" class="open-camera-button">
                    <i class="fas fa-camera"></i> Open Camera
                  </button>
                  
                  <div class="camera-container">
                    <div class="video-wrapper">
                      <video id="camera-preview" class="camera-preview" autoplay playsinline></video>
                    </div>                  
                    <div id="camera-controls" class="camera-controls">
                      <button type="button" id="take-photo" class="camera-button">
                        <i class="fas fa-camera"></i>  
                      </button>
                    </div>
                  </div>
                  <div class="file-upload">
                    <label for="photo-upload" class="upload-label">Or upload a photo :</label>
                    <input type="file" id="photo-upload" accept="image/*" class="form-control" />
                  </div>
                </div>
                <div id="photo-preview" class="photo-preview"></div>
              </div>
              
              <div class="form-group" style="opacity: 0; transform: translateY(20px);">
                <label>Location</label>
                <div class="location-controls">
                  <button type="button" id="get-user-location" class="location-button">
                    <i class="fas fa-map-marker-alt"></i> Use My Location
                  </button>
                </div>
                <div class="location-hint">
                  <i class="fas fa-info-circle"></i> Or click on map to select a location
                </div>
                <div id="location-map" class="location-map"></div>
                <div class="location-coordinates">
                  <span>Latitude: <span id="latitude">Not selected</span></span>
                  <span>Longitude: <span id="longitude">Not selected</span></span>
                </div>
              </div>
              
              <button type="submit" class="submit-button" style="opacity: 0; transform: translateY(20px);">
                <i class="fas fa-paper-plane"></i>Post Story
              </button>
            </form>
          </section>
        </div>
    `}async afterRender(){this.cameraHelper.init("camera-container","camera-preview","camera-controls","photo-preview"),this.mapLocationHelper.init("location-map","latitude","longitude"),this._setupForm(),this._setupCameraButton(),this._animateFormElements(),setTimeout(()=>{this.mapLocationHelper.invalidateSize()},100),window.addEventListener("hashchange",this._cleanup)}_setupCameraButton(){const e=document.getElementById("open-camera"),o=document.getElementById("photo-upload");e.addEventListener("click",async()=>{const r=document.querySelector(".camera-container");r.style.display="block",e.style.display="none",await this.cameraHelper.startCamera()||(u("Could not access camera. Please use file upload instead.","error"),r.style.display="none",e.style.display="block")}),o.addEventListener("change",r=>{const n=r.target.files[0];n&&this.cameraHelper.handleFileUpload(n)})}_animateFormElements(){const e=document.querySelector(".add-story__title"),o=document.querySelectorAll(".form-group"),r=document.querySelector(".submit-button");q.animateElement(e,{delay:100,transform:"translateY(0)"}),q.animateFormElements(o),q.animateElement(r,{delay:200+o.length*150,transform:"translateY(0)"})}_setupForm(){const e=document.getElementById("story-form"),o=e.querySelector(".submit-button");e.addEventListener("submit",async r=>{r.preventDefault();const n=this.cameraHelper.photoFile;if(!n){u("Please add a photo","error");return}const s=document.getElementById("description").value,i=this.mapLocationHelper.userLocation,l=o.innerHTML;o.classList.add("loading"),o.innerHTML='Posting...<i class="fas fa-spinner fa-spin"></i>',o.disabled=!0;try{await this.presenter.handleAddStory({description:s,photo:n,lat:i==null?void 0:i.lat,lon:i==null?void 0:i.lng}),this.cameraHelper.cleanup()}catch{o.classList.remove("loading"),o.innerHTML=l,o.disabled=!1}})}}class Bi{constructor(e,o){this.formId=e,this.submitCallback=o,this.form=null,this.submitButton=null,this._handleSubmit=this._handleSubmit.bind(this)}init(){return this.form=document.getElementById(this.formId),this.form?(this.submitButton=this.form.querySelector('button[type="submit"]'),this.form.addEventListener("submit",this._handleSubmit),!0):(console.error(`Form with ID "${this.formId}" not found`),!1)}async _handleSubmit(e){e.preventDefault();const o=this._getFormData();if(!this._validateFormData(o))return;const r=this.submitButton.innerHTML;this.submitButton.classList.add("loading"),this.submitButton.innerHTML='Logging in... <i class="fas fa-spinner fa-spin"></i>',this.submitButton.disabled=!0;try{await this.submitCallback(o)}catch(n){console.error("Form submission error:",n),u(n.message||"An error occurred. Please try again.","error")}finally{this.submitButton.classList.remove("loading"),this.submitButton.innerHTML=r,this.submitButton.disabled=!1}}_getFormData(){const e={},o=this.form.elements;for(let r=0;r<o.length;r++){const n=o[r];n.name&&n.name!==""&&(e[n.name]=n.value)}return e}_validateFormData(e){return e.email&&!this._isValidEmail(e.email)?(u("Please enter a valid email address","error"),!1):e.password&&e.password.length<8?(u("Password must be at least 8 characters long","error"),!1):!0}_isValidEmail(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}}class Ci{constructor(e){this.view=e,this.api=ye}async handleLogin(e){try{const{loginResult:o}=await this.api.login({email:e.email,password:e.password});localStorage.setItem("token",o.token),localStorage.setItem("name",o.name),document.dispatchEvent(new Event("authChanged")),u("Login successful!"),window.location.hash="#/"}catch(o){throw console.error("Login failed:",o),o}}}class Pi{constructor(){this.authForm=null,this.presenter=new Ci(this)}async render(){return`
        <section class="auth-form">
          <h1 class="auth-form__title">LOGIN</h1>
          <form id="login-form" class="form">
            <div class="form-group form-group--icon">
              <label for="email">Email</label>
              <i class="fas fa-envelope"></i>
              <input 
                type="email" 
                id="email" 
                name="email" 
                class="form-control" 
                placeholder="Enter your email"
                required
                aria-required="true"
              >
            </div>
            
            <div class="form-group form-group--icon">
              <label for="password">Password</label>
              <i class="fas fa-lock"></i>
              <input 
                type="password" 
                id="password" 
                name="password" 
                class="form-control" 
                placeholder="Enter your password"
                required
                aria-required="true"
              >
            </div>
            
            <button type="submit" class="submit-button">
              <i class="fas fa-sign-in-alt"></i> Login
            </button>
          </form>
          
          <p class="auth-form__footer">
            Don't have an account? <a href="#/register">Register here</a>
          </p>
        </section>
    `}async afterRender(){this.authForm=new Bi("login-form",this.presenter.handleLogin.bind(this.presenter)),this.authForm.init()}}class Ai{constructor(e){this.view=e,this.api=ye}async handleRegister(e){try{await this.api.register(e),u("Registration successful! Please login."),window.location.hash="#/login"}catch(o){throw console.error("Registration failed:",o),o}}}class xi{constructor(){this.presenter=new Ai(this)}async render(){return`
        <section class="auth-form">
          <h1 class="auth-form__title">REGISTER</h1>
          <form id="register-form" class="form">
            <div class="form-group form-group--icon">
              <label for="name">Name</label>
              <i class="fas fa-user"></i>
              <input 
                type="text" 
                id="name" 
                name="name" 
                class="form-control" 
                placeholder="Enter your full name"
                required
                aria-required="true"
              >
            </div>
            
            <div class="form-group form-group--icon">
              <label for="email">Email</label>
              <i class="fas fa-envelope"></i>
              <input 
                type="email" 
                id="email" 
                name="email" 
                class="form-control" 
                placeholder="Enter your email"
                required
                aria-required="true"
              >
            </div>
            
            <div class="form-group form-group--icon">
              <label for="password">Password</label>
              <i class="fas fa-lock"></i>
              <input 
                type="password" 
                id="password" 
                name="password" 
                class="form-control" 
                placeholder="Enter Your password"
                required
                aria-required="true"
                minlength="8"
              >
            </div>
            
            <button type="submit" class="submit-button">
              <i class="fas fa-user-plus"></i> Register
            </button>
          </form>
          
          <p class="auth-form__footer">
            Already have an account? <a href="#/login">Login here</a>
          </p>
        </section>
    `}async afterRender(){const e=document.getElementById("register-form"),o=e.querySelector(".submit-button");e.addEventListener("submit",async r=>{r.preventDefault(),o.classList.add("loading"),o.innerHTML="Registering...";const n=document.getElementById("name").value,s=document.getElementById("email").value,i=document.getElementById("password").value;try{await this.presenter.handleRegister({name:n,email:s,password:i})}catch{o.classList.remove("loading"),o.innerHTML='<i class="fas fa-user-plus"></i> Register'}})}}class Ii{constructor(e){this._view=e,this._storyApi=ye}async handleAddStory({description:e,photo:o,lat:r,lon:n}){try{if(!o){u("Please add a photo","error");return}if(!e.trim()){u("Please add a description","error");return}const s=await this._storyApi.addGuestStory({description:e,photo:o,lat:r,lon:n});if(s.error)throw new Error(s.message||"Failed to add guest story");return u("Guest story added successfully!","success"),setTimeout(()=>{window.location.hash="#/"},1500),!0}catch(s){return X.isOnline?E.handleFormError(s,{context:"Adding guest story",defaultMessage:"Failed to add guest story. Please try again."}):E.handleOfflineError(s,{offlineAction:()=>(u("Your guest story has been saved offline and will be uploaded when you are back online","info"),setTimeout(()=>{window.location.hash="#/"},2e3),!0)})}}}class Ti{constructor(){Xe(this,"_cleanup",()=>{this.cameraHelper.cleanup(),window.removeEventListener("hashchange",this._cleanup)});this.cameraHelper=new er,this.mapLocationHelper=new tr,this.presenter=new Ii(this)}async render(){return`
        <div class="container">
          <section class="add-story">
            <form id="guest-story-form" class="story-form">
              <h1 class="add-story__title" style="opacity: 0; transform: translateY(-20px);">Share Your Story as Guest</h1>
              <p class="guest-note"><i class="fas fa-info-circle"></i> You're posting as a guest. Your story will be attributed to "Guest".</p>
              
              <div class="form-group" style="opacity: 0; transform: translateY(20px);">
                <label for="description">Description</label>
                <textarea 
                  id="description" 
                  name="description" 
                  class="form-control" 
                  rows="5" 
                  required
                  aria-required="true"
                  placeholder="Share your story..."
                ></textarea>
              </div>
              
              <div class="form-group" style="opacity: 0; transform: translateY(20px);">
                <label>Photo</label>
                <div class="photo-options">
                  <button type="button" id="open-camera" class="open-camera-button">
                    <i class="fas fa-camera"></i> Open Camera
                  </button>
                  
                  <div class="camera-container">
                    <div class="video-wrapper">
                      <video id="camera-preview" class="camera-preview" autoplay playsinline></video>
                    </div>                  
                    <div id="camera-controls" class="camera-controls">
                      <button type="button" id="take-photo" class="camera-button">
                        <i class="fas fa-camera"></i>  
                      </button>
                    </div>
                  </div>
                  <div class="file-upload">
                    <label for="photo-upload" class="upload-label">Or upload a photo :</label>
                    <input type="file" id="photo-upload" accept="image/*" class="form-control" />
                  </div>
                </div>
                <div id="photo-preview" class="photo-preview"></div>
              </div>
              
              <div class="form-group" style="opacity: 0; transform: translateY(20px);">
                <label>Location</label>
                <div class="location-controls">
                  <button type="button" id="get-user-location" class="location-button">
                    <i class="fas fa-map-marker-alt"></i> Use My Location
                  </button>
                </div>
                <div class="location-hint">
                  <i class="fas fa-info-circle"></i> Or click on map to select a location
                </div>
                <div id="location-map" class="location-map"></div>
                <div class="location-coordinates">
                  <span>Latitude: <span id="latitude">Not selected</span></span>
                  <span>Longitude: <span id="longitude">Not selected</span></span>
                </div>
              </div>
              
              <div class="form-actions">
                <button type="submit" class="submit-button" style="opacity: 0; transform: translateY(20px);">
                  <i class="fas fa-paper-plane"></i> Post Story
                </button>
              </div>
            </form>
          </section>
        </div>
    `}async afterRender(){this.cameraHelper.init("camera-container","camera-preview","camera-controls","photo-preview"),this.mapLocationHelper.init("location-map","latitude","longitude"),this._setupForm(),this._setupCameraButton(),this._animateFormElements(),setTimeout(()=>{this.mapLocationHelper.invalidateSize()},100),window.addEventListener("hashchange",this._cleanup)}_setupCameraButton(){const e=document.getElementById("open-camera"),o=document.getElementById("photo-upload");e.addEventListener("click",async()=>{const r=document.querySelector(".camera-container");r.style.display="block",e.style.display="none",await this.cameraHelper.startCamera()||(u("Could not access camera. Please use file upload instead.","error"),r.style.display="none",e.style.display="block")}),o.addEventListener("change",r=>{const n=r.target.files[0];n&&this.cameraHelper.handleFileUpload(n)})}_animateFormElements(){const e=document.querySelector(".add-story__title"),o=document.querySelectorAll(".form-group"),r=document.querySelector(".submit-button");q.animateElement(e,{delay:100,transform:"translateY(0)"}),q.animateFormElements(o),q.animateElement(r,{delay:200+o.length*150,transform:"translateY(0)"})}_setupForm(){const e=document.getElementById("guest-story-form"),o=e.querySelector(".submit-button");e.addEventListener("submit",async r=>{r.preventDefault();const n=this.cameraHelper.photoFile;if(!n){u("Please add a photo","error");return}const s=document.getElementById("description").value,i=this.mapLocationHelper.userLocation,l=o.innerHTML;o.classList.add("loading"),o.innerHTML='Posting...<i class="fas fa-spinner fa-spin"></i>',o.disabled=!0;try{await this.presenter.handleAddStory({description:s,photo:n,lat:i==null?void 0:i.lat,lon:i==null?void 0:i.lng}),this.cameraHelper.cleanup()}catch{o.classList.remove("loading"),o.innerHTML=l,o.disabled=!1}})}}class or{async render(){return`
          <div class="not-found-container">
            <div class="not-found-content">
              <h1>404 woy</h1>
              <h2>Page Not Found</h2>
              <p>The page you're looking for doesn't exist or has been moved.</p>
              <a href="#/" class="not-found-button">Back to Home</a>
            </div>
          </div>
      `}async afterRender(){}}class $i{constructor(e){this._view=e,this._storyIDB=M}async loadBookmarks(){try{const e=await this._storyIDB.getAllBookmarks();return this._view.displayBookmarks(e),e}catch(e){return E.handleApiError(e,{context:"Loading bookmarks",defaultMessage:"Failed to retrieve your bookmarks"}),[]}}async onBookmarkRemoved(e){try{await this._storyIDB.isBookmarked(e)&&await this._storyIDB.removeBookmark(e)}catch(o){console.error("Error confirming bookmark removal:",o)}}}class Mi{constructor(){this._presenter=new $i(this)}async render(){return`
      <section class="bookmarks-page">
        <h2 class="page-title">Your Bookmarked Stories</h2>
        
        <div class="bookmarks-container">
          <story-list id="bookmarks-list" class="story-grid"></story-list>
        </div>
      </section>
    `}async afterRender(){try{const e=document.querySelector("#bookmarks-list");await this._presenter.loadBookmarks(),this._initBookmarkRemovedListener(e)}catch(e){E.handleApiError(e,{context:"Loading bookmarks",defaultMessage:"Failed to load your bookmarks"})}}displayBookmarks(e){const o=document.querySelector("#bookmarks-list");if(e.length===0){this._renderEmptyBookmarks(o);return}o.stories=e}_renderEmptyBookmarks(e){const o=document.createElement("div");o.className="no-bookmarks",o.innerHTML=`
      <i class="fas fa-bookmark empty-icon"></i>
      <p>You haven't bookmarked any stories yet</p>
      <a href="#/" class="explore__button">Explore Stories</a>
    `,e.innerHTML="",e.appendChild(o),q.animateElement(o,{delay:100,transform:"scale(1)",duration:"0.6s"})}_initBookmarkRemovedListener(e){document.addEventListener("bookmark:removed",async o=>{if(o.detail&&o.detail.storyId){const r=o.detail.storyId;await this._presenter.onBookmarkRemoved(r);const n=e.querySelector(`story-card[data-story-id="${r}"]`);n&&q.animateElement(n,{opacity:"0",transform:"translateX(20px)",duration:"0.3s",callback:()=>{n.remove(),e.querySelectorAll("story-card").length===0&&this._renderEmptyBookmarks(e)}})}})}}const Oi={"/":new Gt,"/home":new Gt,"/guest":new bi,"/stories/:id":new Si,"/add-story":new Li,"/login":new Pi,"/register":new xi,"/add-guest-story":new Ti,"/bookmarks":new Mi,"*":new or},Di=T.PUSH_MSG_VAPID_PUBLIC_KEY;class Ie{static async checkPermission(){return"Notification"in window?Notification.permission==="granted"?!0:await Notification.requestPermission()==="granted":(console.log("Browser does not support notifications"),!1)}static async registerServiceWorker(){if(!("serviceWorker"in navigator))return console.log("Service Worker not supported"),!1;try{const e=await navigator.serviceWorker.register("/service-worker.js");return console.log("Service Worker registered"),e}catch(e){return console.error("Service Worker registration failed:",e),!1}}static async subscribeToPush(e){try{return await e.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:this.urlBase64ToUint8Array(Di)})}catch(o){return console.error("Failed to subscribe to push:",o),null}}static async sendSubscriptionToServer(e){const o=localStorage.getItem("token");if(!o)return!1;try{return(await fetch(`${T.BASE_URL}${T.ENDPOINTS.NOTIFICATIONS.SUBSCRIBE}`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${o}`},body:JSON.stringify({endpoint:e.endpoint,keys:{p256dh:e.toJSON().keys.p256dh,auth:e.toJSON().keys.auth}})})).ok}catch(r){return console.error("Error sending subscription to server:",r),!1}}static urlBase64ToUint8Array(e){const o="=".repeat((4-e.length%4)%4),r=(e+o).replace(/-/g,"+").replace(/_/g,"/"),n=window.atob(r),s=new Uint8Array(n.length);for(let i=0;i<n.length;++i)s[i]=n.charCodeAt(i);return s}static async showNotification(e,o){if(!await this.checkPermission())return;(await navigator.serviceWorker.ready).showNotification(e,o)}static async initPushNotifications(){if(!await this.checkPermission())return!1;const e=await this.registerServiceWorker();if(!e)return!1;const o=await this.subscribeToPush(e);return o?await this.sendSubscriptionToServer(o):!1}static async notifyStoryCreated(e,o=!1){if(!await this.checkPermission())return!1;try{const r=e.length>30?`${e.substring(0,30)}...`:e,n={title:o?"Guest story berhasil dibuat":"Story berhasil dibuat",options:{body:o?`Story tamu telah dibuat dengan deskripsi: ${r}`:`Anda telah membuat story baru dengan deskripsi: ${r}`}};return await this.showNotification(n.title,n.options),!0}catch(r){return console.error("Failed to show story creation notification:",r),!1}}static async unsubscribeFromPush(){if(!("serviceWorker"in navigator))return!1;try{const o=await(await navigator.serviceWorker.ready).pushManager.getSubscription();return o&&(await this.sendUnsubscribeToServer(o),await o.unsubscribe()),!0}catch(e){return console.error("Failed to unsubscribe from push:",e),!1}}static async sendUnsubscribeToServer(e){const o=localStorage.getItem("token");if(!o)return!1;try{return new Promise((r,n)=>{const s=new XMLHttpRequest;s.open("DELETE",`${T.BASE_URL}${T.ENDPOINTS.NOTIFICATIONS.UNSUBSCRIBE}`,!0),s.setRequestHeader("Content-Type","application/json"),s.setRequestHeader("Authorization",`Bearer ${o}`),s.onload=function(){s.status>=200&&s.status<300?r(!0):n(new Error(`HTTP error! status: ${s.status}`))},s.onerror=function(){n(new Error("Network error occurred"))},s.send(JSON.stringify({endpoint:e.endpoint}))})}catch(r){return console.error("Error sending unsubscription to server:",r),!1}}static async isSubscribed(){if(!("serviceWorker"in navigator))return!1;try{return!!await(await navigator.serviceWorker.ready).pushManager.getSubscription()}catch(e){return console.error("Error checking subscription status:",e),!1}}static async togglePushNotification(){return await this.isSubscribed()?await this.unsubscribeFromPush():await this.initPushNotifications()}static async toggleNavPushNotification(){return await this.isSubscribed()?await this.unsubscribeFromPush():await this.initPushNotifications()}}var N,ue,R,Ee,S,rr,nr,ke,je,sr,ir,mt,ar;class Fi{constructor({navigationDrawer:e,drawerButton:o,content:r}){Z(this,S);Z(this,N,null);Z(this,ue,null);Z(this,R,null);Z(this,Ee,null);Z(this,je,()=>{localStorage.removeItem("token"),localStorage.removeItem("name"),u("Logged out successfully"),H(this,S,ke).call(this),window.location.hash="#/login"});if(!r)throw new Error("Content element is required");be(this,N,r),be(this,ue,o),be(this,R,e),H(this,S,rr).call(this),H(this,S,nr).call(this),H(this,S,ke).call(this),H(this,S,sr).call(this);const n=document.querySelector(".skip-link");n&&n.addEventListener("click",s=>{s.preventDefault(),document.getElementById("main-content").setAttribute("tabindex","-1"),document.getElementById("main-content").focus()})}async _initNotificationButton(){const e=document.getElementById("notification-btn");if(e)try{const o=await Ie.isSubscribed();this._updateNotificationButtonState(e,o),e.addEventListener("click",async()=>{try{e.disabled=!0;const r=await Ie.togglePushNotification(),n=await Ie.isSubscribed();r?u(n?"Successfully subscribed to notifications":"Successfully unsubscribed from notifications","success"):u("Failed to update notification settings","error"),this._updateNotificationButtonState(e,n)}catch(r){console.error("Error toggling notifications:",r),u("Error updating notification settings","error")}finally{e.disabled=!1}})}catch(o){console.error("Error initializing notification button:",o)}}_updateNotificationButtonState(e,o){const r=e.querySelector("i");r.className=o?"fas fa-bell":"far fa-bell",e.title=o?"Unsubscribe from notifications":"Subscribe to notifications",e.innerHTML=`${r.outerHTML} ${o?"Subscribed":"Notifications"}`}async renderPage(){try{const e=Kt(),o=Oi[e]||new or;if(!o){window.location.hash="#/";return}const r=localStorage.getItem("token");if((e==="/"||e==="/home")&&!r){window.location.hash="#/guest";return}if((e==="/add-story"||e==="/profile")&&!r){u("Please login to access this page","error"),window.location.hash="#/login";return}H(this,S,ar).call(this,e);const n=b(this,Ee),s=H(this,S,ir).call(this,e);be(this,Ee,s);const i=window.matchMedia("(prefers-reduced-motion: reduce)").matches;document.startViewTransition&&!i?await document.startViewTransition(async()=>{b(this,N).innerHTML=await o.render(),b(this,N).className=s,n&&H(this,S,mt).call(this,n,s),await o.afterRender()}).finished:(b(this,N).innerHTML=await o.render(),b(this,N).className=s,n&&H(this,S,mt).call(this,n,s),await o.afterRender())}catch(e){console.error("Render error:",e),b(this,N).innerHTML=`
        <div class="error-state">
          <div class="error-icon">
            <i class="fas fa-exclamation-circle"></i>
          </div>
          <h2>Something went wrong</h2>
          <p>${navigator.onLine?"Failed to load content.":"You are offline. Some content may not be available."}</p>
          <button id="error-retry" class="retry-button">Try Again</button>
        </div>
      `;const o=document.getElementById("error-retry");o&&o.addEventListener("click",()=>{navigator.onLine?(u("Retrying...","info"),this.renderPage()):u("Still offline. Your changes will be saved and synced when online.","warning")})}}}N=new WeakMap,ue=new WeakMap,R=new WeakMap,Ee=new WeakMap,S=new WeakSet,rr=function(){const e=document.getElementById("nav-menu-overlay");b(this,ue).addEventListener("click",()=>{b(this,R).classList.toggle("open"),e&&e.classList.toggle("active")}),e&&e.addEventListener("click",()=>{b(this,R).classList.remove("open"),e.classList.remove("active")}),document.body.addEventListener("click",o=>{!b(this,R).contains(o.target)&&!b(this,ue).contains(o.target)&&(b(this,R).classList.remove("open"),e&&e.classList.remove("active")),b(this,R).querySelectorAll("a").forEach(r=>{r.contains(o.target)&&(b(this,R).classList.remove("open"),e&&e.classList.remove("active"))})})},nr=function(){!localStorage.getItem("token")&&Kt()==="/add-story"&&(u("Please login to add a story","error"),window.location.hash="#/login")},ke=function(){const e=b(this,R).querySelector("#auth-links"),o=localStorage.getItem("token"),r=localStorage.getItem("name");o?(e.innerHTML=`
        <li><a href="#/add-story" class="nav-link">
          <i class="fas fa-plus-circle"></i> Add Story
        </a></li>
        <li><a href="#/bookmarks" class="nav-link">
          <i class="fas fa-bookmark"></i> Bookmarks
        </a></li>
        <li><button id="notification-btn" class="nav-link notification-btn">
          <i class="far fa-bell"></i> Notifications
        </button></li>
        <li><a href="#/profile" class="nav-link user-info">
          <i class="fas fa-user"></i> ${r}
        </a></li>
        <li><a href="#" id="logout-btn" class="nav-link">
          <i class="fas fa-sign-out-alt"></i> Logout
        </a></li>
      `,this._initNotificationButton(),e.querySelector("#logout-btn").addEventListener("click",b(this,je))):e.innerHTML=`
        <li><a href="#/login" class="nav-link">
          <i class="fas fa-sign-in-alt"></i> Login
        </a></li>
      `},je=new WeakMap,sr=function(){window.addEventListener("storage",e=>{(e.key==="token"||e.key==="name")&&H(this,S,ke).call(this)}),document.addEventListener("authChanged",()=>{H(this,S,ke).call(this)})},ir=function(e){return e==="/"||e==="/home"||e==="/guest"?"page-home":e.includes("/stories/")?"page-detail":e==="/add-story"||e==="/add-guest-story"?"page-add-story":e==="/login"||e==="/register"?"page-auth":"page-default"},mt=function(e,o){b(this,N).style.animation="none",b(this,N).offsetWidth;let r;e==="page-home"&&o==="page-detail"?r="slideInRight":e==="page-detail"&&o==="page-home"?r="slideInLeft":o==="page-add-story"?r="scaleUp":r="fadeIn",b(this,N).style.animation=`${r} 0.5s ease-out forwards`},ar=function(e){b(this,R).querySelectorAll(".nav-link").forEach(r=>{r.getAttribute("href")===`#${e}`?r.classList.add("active"):r.classList.remove("active")})};try{self["workbox:window:7.2.0"]&&_()}catch{}function Xt(t,e){return new Promise(function(o){var r=new MessageChannel;r.port1.onmessage=function(n){o(n.data)},t.postMessage(e,[r.port2])})}function Hi(t){var e=function(o,r){if(typeof o!="object"||!o)return o;var n=o[Symbol.toPrimitive];if(n!==void 0){var s=n.call(o,r);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(o)}(t,"string");return typeof e=="symbol"?e:e+""}function Ni(t,e){for(var o=0;o<e.length;o++){var r=e[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Hi(r.key),r)}}function ft(t,e){return ft=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,r){return o.__proto__=r,o},ft(t,e)}function Jt(t,e){(e==null||e>t.length)&&(e=t.length);for(var o=0,r=new Array(e);o<e;o++)r[o]=t[o];return r}function Ri(t,e){var o=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(o)return(o=o.call(t)).next.bind(o);if(Array.isArray(t)||(o=function(n,s){if(n){if(typeof n=="string")return Jt(n,s);var i=Object.prototype.toString.call(n).slice(8,-1);return i==="Object"&&n.constructor&&(i=n.constructor.name),i==="Map"||i==="Set"?Array.from(n):i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?Jt(n,s):void 0}}(t))||e){o&&(t=o);var r=0;return function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}try{self["workbox:core:7.2.0"]&&_()}catch{}var nt=function(){var t=this;this.promise=new Promise(function(e,o){t.resolve=e,t.reject=o})};function st(t,e){var o=location.href;return new URL(t,o).href===new URL(e,o).href}var ve=function(t,e){this.type=t,Object.assign(this,e)};function Y(t,e,o){return o?e?e(t):t:(t&&t.then||(t=Promise.resolve(t)),e?t.then(e):t)}function ji(){}var qi={type:"SKIP_WAITING"};function Zt(t,e){return t&&t.then?t.then(ji):Promise.resolve()}var Ui=function(t){function e(l,c){var d,m;return c===void 0&&(c={}),(d=t.call(this)||this).nn={},d.tn=0,d.rn=new nt,d.en=new nt,d.on=new nt,d.un=0,d.an=new Set,d.cn=function(){var p=d.fn,g=p.installing;d.tn>0||!st(g.scriptURL,d.sn.toString())||performance.now()>d.un+6e4?(d.vn=g,p.removeEventListener("updatefound",d.cn)):(d.hn=g,d.an.add(g),d.rn.resolve(g)),++d.tn,g.addEventListener("statechange",d.ln)},d.ln=function(p){var g=d.fn,P=p.target,J=P.state,Ge=P===d.vn,Ke={sw:P,isExternal:Ge,originalEvent:p};!Ge&&d.mn&&(Ke.isUpdate=!0),d.dispatchEvent(new ve(J,Ke)),J==="installed"?d.wn=self.setTimeout(function(){J==="installed"&&g.waiting===P&&d.dispatchEvent(new ve("waiting",Ke))},200):J==="activating"&&(clearTimeout(d.wn),Ge||d.en.resolve(P))},d.yn=function(p){var g=d.hn,P=g!==navigator.serviceWorker.controller;d.dispatchEvent(new ve("controlling",{isExternal:P,originalEvent:p,sw:g,isUpdate:d.mn})),P||d.on.resolve(g)},d.gn=(m=function(p){var g=p.data,P=p.ports,J=p.source;return Y(d.getSW(),function(){d.an.has(J)&&d.dispatchEvent(new ve("message",{data:g,originalEvent:p,ports:P,sw:J}))})},function(){for(var p=[],g=0;g<arguments.length;g++)p[g]=arguments[g];try{return Promise.resolve(m.apply(this,p))}catch(P){return Promise.reject(P)}}),d.sn=l,d.nn=c,navigator.serviceWorker.addEventListener("message",d.gn),d}var o,r;r=t,(o=e).prototype=Object.create(r.prototype),o.prototype.constructor=o,ft(o,r);var n,s,i=e.prototype;return i.register=function(l){var c=(l===void 0?{}:l).immediate,d=c!==void 0&&c;try{var m=this;return Y(function(p,g){var P=p();return P&&P.then?P.then(g):g(P)}(function(){if(!d&&document.readyState!=="complete")return Zt(new Promise(function(p){return window.addEventListener("load",p)}))},function(){return m.mn=!!navigator.serviceWorker.controller,m.dn=m.pn(),Y(m.bn(),function(p){m.fn=p,m.dn&&(m.hn=m.dn,m.en.resolve(m.dn),m.on.resolve(m.dn),m.dn.addEventListener("statechange",m.ln,{once:!0}));var g=m.fn.waiting;return g&&st(g.scriptURL,m.sn.toString())&&(m.hn=g,Promise.resolve().then(function(){m.dispatchEvent(new ve("waiting",{sw:g,wasWaitingBeforeRegister:!0}))}).then(function(){})),m.hn&&(m.rn.resolve(m.hn),m.an.add(m.hn)),m.fn.addEventListener("updatefound",m.cn),navigator.serviceWorker.addEventListener("controllerchange",m.yn),m.fn})}))}catch(p){return Promise.reject(p)}},i.update=function(){try{return this.fn?Y(Zt(this.fn.update())):Y()}catch(l){return Promise.reject(l)}},i.getSW=function(){return this.hn!==void 0?Promise.resolve(this.hn):this.rn.promise},i.messageSW=function(l){try{return Y(this.getSW(),function(c){return Xt(c,l)})}catch(c){return Promise.reject(c)}},i.messageSkipWaiting=function(){this.fn&&this.fn.waiting&&Xt(this.fn.waiting,qi)},i.pn=function(){var l=navigator.serviceWorker.controller;return l&&st(l.scriptURL,this.sn.toString())?l:void 0},i.bn=function(){try{var l=this;return Y(function(c,d){try{var m=c()}catch(p){return d(p)}return m&&m.then?m.then(void 0,d):m}(function(){return Y(navigator.serviceWorker.register(l.sn,l.nn),function(c){return l.un=performance.now(),c})},function(c){throw c}))}catch(c){return Promise.reject(c)}},n=e,(s=[{key:"active",get:function(){return this.en.promise}},{key:"controlling",get:function(){return this.on.promise}}])&&Ni(n.prototype,s),Object.defineProperty(n,"prototype",{writable:!1}),n}(function(){function t(){this.Pn=new Map}var e=t.prototype;return e.addEventListener=function(o,r){this.jn(o).add(r)},e.removeEventListener=function(o,r){this.jn(o).delete(r)},e.dispatchEvent=function(o){o.target=this;for(var r,n=Ri(this.jn(o.type));!(r=n()).done;)(0,r.value)(o)},e.jn=function(o){return this.Pn.has(o)||this.Pn.set(o,new Set),this.Pn.get(o)},t}());function zi(){const t=document.createElement("button");return t.id="installButton",t.className="install-button",t.innerHTML='<i class="fas fa-download"></i> Install App',t.style.display="none",t.addEventListener("click",async()=>{if(!window.deferredPrompt){u("Installation not available","error");return}window.deferredPrompt.prompt(),(await window.deferredPrompt.userChoice).outcome==="accepted"?u("App installed successfully!","success"):u("App installation cancelled","info"),window.deferredPrompt=null,t.style.display="none"}),document.body.appendChild(t),t}async function Wi(){try{if("serviceWorker"in navigator){const s=new Ui("/service-worker.js",{scope:"/"});s.addEventListener("installed",i=>{i.isUpdate?(console.log("App updated"),u("App Updated!","info")):(console.log("App installed and cached for offline use"),window.matchMedia("(display-mode: browser)").matches&&window.dispatchEvent(new Event("showInstallPrompt")))}),s.addEventListener("activated",i=>{i.isUpdate||console.log("Service worker activated for the first time")}),s.addEventListener("waiting",i=>{u("New version available! Refresh to update.","info")});try{await s.register(),console.log("Service worker registered"),localStorage.getItem("token")&&await Ie.initPushNotifications()}catch(i){console.error("Service worker registration failed:",i)}}const t=document.getElementById("main-content");if(!t)throw new Error("Main content element not found");const e=new Fi({content:t,drawerButton:document.querySelector("#drawer-button"),navigationDrawer:document.querySelector("#navigation-drawer")}),o=localStorage.getItem("token");!window.location.hash&&!o&&(window.location.hash="#/guest"),await e.renderPage(),window.addEventListener("hashchange",()=>e.renderPage());const n=zi();window.addEventListener("beforeinstallprompt",s=>{s.preventDefault(),window.deferredPrompt=s,n.style.display="block"}),window.addEventListener("appinstalled",()=>{console.log("PWA installed successfully"),n.style.display="none",window.deferredPrompt=null})}catch(t){console.error("Application initialization failed:",t);const e=document.createElement("div");e.style.padding="20px",e.style.color="red",e.textContent="Failed to initialize application. Please refresh the page.";const o=document.getElementById("main-content")||document.body;o.innerHTML="",o.appendChild(e)}}document.addEventListener("DOMContentLoaded",Wi);
